<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predict CLV from a fitted transaction model — predict.clv.fitted.transactions • CLVTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predict CLV from a fitted transaction model — predict.clv.fitted.transactions"><meta property="og:description" content='Probabilistic customer attrition models predict in general three expected characteristics for every customer:
"conditional expected transactions" (CET), which is the number of transactions to expect from a customer
during the prediction period,
"probability of a customer being alive" (PAlive) at the end of the estimation period and
"discounted expected residual transactions" (DERT) for every customer, which is the total number of
transactions for the residual lifetime of a customer discounted to the end of the estimation period.
In the case of time-varying covariates, instead of DERT, "discounted expected conditional transactions" (DECT)
is predicted. DECT does only cover a finite time horizon in contrast to DERT.
For continuous.discount.factor=0, DECT corresponds to CET.


In order to derive a monetary value such as CLV, customer spending has to be considered.
If the clv.data object contains spending information, customer spending can be predicted using a Gamma/Gamma spending model for
parameter predict.spending and the predicted CLV is be calculated (if the transaction model supports DERT/DECT).
In this case, the prediction additionally contains the following two columns:
"predicted.mean.spending", the mean spending per transactions as predicted by the spending model.
"CLV", the customer lifetime value. CLV is the product of DERT/DECT and predicted spending.


Uncertainty estimates are available for all predicted quantities using bootstrapping.

New customer prediction
The fitted model can also be used to predict the number of transactions a fictional, single, average
newly alive customer is expected to make at the moment of the first transaction ("coming alive").
This is, for a customer which has no existing order history.
For covariate models, the prediction is for an average customer with the given covariates.
The individual-level unconditional expectation that is also used for the
tracking plot is used to obtain this prediction.
For models without covariates, the prediction hence is the same for all customers
and independent of when a customer comes alive.
For models with covariates, the prediction is the same for all customers
with the same covariates.
The data on which the model was fit and which is stored in it is NOT used for this prediction.
See examples and newcustomer for more details.

'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-2');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLVTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.12.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/CLVTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bachmannpatrick/CLVTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict CLV from a fitted transaction model</h1>
    <small class="dont-index">Source: <a href="https://github.com/bachmannpatrick/CLVTools/blob/master/R/f_interface_predict_clvfittedtransactions.R" class="external-link"><code>R/f_interface_predict_clvfittedtransactions.R</code></a></small>
    <div class="hidden name"><code>predict.clv.fitted.transactions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Probabilistic customer attrition models predict in general three expected characteristics for every customer:</p><ul><li><p>"conditional expected transactions" (<code>CET</code>), which is the number of transactions to expect from a customer
during the prediction period,</p></li>
<li><p>"probability of a customer being alive" (<code>PAlive</code>) at the end of the estimation period and</p></li>
<li><p>"discounted expected residual transactions" (<code>DERT</code>) for every customer, which is the total number of
transactions for the residual lifetime of a customer discounted to the end of the estimation period.
In the case of time-varying covariates, instead of <code>DERT</code>, "discounted expected conditional transactions" (<code>DECT</code>)
is predicted. <code>DECT</code> does only cover a finite time horizon in contrast to <code>DERT</code>.
For <code>continuous.discount.factor=0</code>, <code>DECT</code> corresponds to <code>CET</code>.</p></li>
</ul><p>In order to derive a monetary value such as CLV, customer spending has to be considered.
If the <code>clv.data</code> object contains spending information, customer spending can be predicted using a Gamma/Gamma spending model for
parameter <code>predict.spending</code> and the predicted CLV is be calculated (if the transaction model supports <code>DERT/DECT</code>).
In this case, the prediction additionally contains the following two columns:</p><ul><li><p>"predicted.mean.spending", the mean spending per transactions as predicted by the spending model.</p></li>
<li><p>"CLV", the customer lifetime value. CLV is the product of DERT/DECT and predicted spending.</p></li>
</ul><p>Uncertainty estimates are available for all predicted quantities using bootstrapping.</p>
<div class="section">
<h3 id="new-customer-prediction">New customer prediction<a class="anchor" aria-label="anchor" href="#new-customer-prediction"></a></h3>
<p>The fitted model can also be used to predict the number of transactions a fictional, single, average
newly alive customer is expected to make at the moment of the first transaction ("coming alive").
This is, for a customer which has no existing order history.
For covariate models, the prediction is for an average customer with the given covariates.</p>
<p>The individual-level unconditional expectation that is also used for the
<a href="plot.clv.fitted.transactions.html">tracking plot</a> is used to obtain this prediction.
For models without covariates, the prediction hence is the same for all customers
and independent of when a customer comes alive.
For models with covariates, the prediction is the same for all customers
with the same covariates.</p>
<p>The data on which the model was fit and which is stored in it is NOT used for this prediction.
See examples and <a href="newcustomer.html">newcustomer</a> for more details.</p>
</div>

    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'clv.fitted.transactions'</span></span>
<span><span class="fu">predict</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prediction.end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predict.spending <span class="op">=</span> <span class="va">gg</span>,</span>
<span>  continuous.discount.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  uncertainty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"boots"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  num.boots <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'clv.fitted.transactions'</span></span>
<span><span class="fu">predict</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prediction.end <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predict.spending <span class="op">=</span> <span class="va">gg</span>,</span>
<span>  continuous.discount.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  uncertainty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"boots"</span><span class="op">)</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  num.boots <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A fitted clv transaction model for which prediction is desired.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>A clv data object or data for the new customer prediction (see <a href="newcustomer.html">newcustomer</a>) for which predictions should
be made with the fitted model. If none or NULL is given, predictions are made for the data on which the model was fit.</p></dd>


<dt id="arg-prediction-end">prediction.end<a class="anchor" aria-label="anchor" href="#arg-prediction-end"></a></dt>
<dd><p>Until what point in time to predict. This can be the number of periods (numeric) or a form of date/time object. See details.</p></dd>


<dt id="arg-predict-spending">predict.spending<a class="anchor" aria-label="anchor" href="#arg-predict-spending"></a></dt>
<dd><p>Whether and how to predict spending and based on it also CLV, if possible. See details.</p></dd>


<dt id="arg-continuous-discount-factor">continuous.discount.factor<a class="anchor" aria-label="anchor" href="#arg-continuous-discount-factor"></a></dt>
<dd><p>continuous discount factor to use to calculate <code>DERT/DECT</code>. Defaults to a 10% continuous annual rate. See details.</p></dd>


<dt id="arg-uncertainty">uncertainty<a class="anchor" aria-label="anchor" href="#arg-uncertainty"></a></dt>
<dd><p>Method to produce confidence intervals of the predictions (parameter uncertainty). Either "none" (default) or "boots".</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Required confidence level, if <code>uncertainty="boots"</code>.</p></dd>


<dt id="arg-num-boots">num.boots<a class="anchor" aria-label="anchor" href="#arg-num-boots"></a></dt>
<dd><p>Number of bootstrap repetitions, if <code>uncertainty="boots"</code>. A low number may not produce intervals for all customers if they are not sampled.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Show details about the running of the function.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ignored</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>data.table</code> with columns:</p>
<dl><dt>Id</dt>
<dd><p>The respective customer identifier</p></dd>

<dt>period.first</dt>
<dd><p>First timepoint of prediction period</p></dd>

<dt>period.last</dt>
<dd><p>Last timepoint of prediction period</p></dd>

<dt>period.length</dt>
<dd><p>Number of time units covered by the period indicated by <code>period.first</code> and <code>period.last</code> (including both ends).</p></dd>

<dt>PAlive</dt>
<dd><p>Probability to be alive at the end of the estimation period</p></dd>

<dt>CET</dt>
<dd><p>The Conditional Expected Transactions: The number of transactions expected until prediction.end.</p></dd>

<dt>DERT or DECT</dt>
<dd><p>Discounted Expected Residual Transactions or Discounted Expected Conditional Transactions for dynamic covariates models</p></dd>

<dt>actual.x</dt>
<dd><p>Actual number of transactions until prediction.end. Only if there is a holdout period and the prediction ends in it, otherwise not reported.</p></dd>

<dt>actual.period.spending</dt>
<dd><p>Actual total spending until prediction.end. Only if there is a holdout period and the prediction ends in it, otherwise not reported.</p></dd>

<dt>predicted.mean.spending</dt>
<dd><p>The mean spending per transactions as predicted by the spending model.</p></dd>

<dt>predicted.period.spending</dt>
<dd><p>The predicted total spending until prediction.end (<code>CET*predicted.mean.spending</code>).</p></dd>

<dt>predicted.CLV</dt>
<dd><p>Customer Lifetime Value based on <code>DERT*predicted.mean.spending</code>.</p></dd>

<dt>predicted.period.CLV</dt>
<dd><p>Customer Lifetime Value until prediction.end based on <code>DECT*predicted.mean.spending</code>.</p></dd>


</dl><p>If predicting for new customers (using <code><a href="newcustomer.html">newcustomer()</a></code>), a numeric scalar indicating the expected
number of transactions is returned instead.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>predict.spending</code> indicates whether to predict customers' spending and if so, the spending model to use.
Accepted inputs are either a logical (<code>TRUE/FALSE</code>), a method to fit a spending model (i.e. <code><a href="gg.html">gg</a></code>), or
an already fitted spending model. If provided <code>TRUE</code>, a Gamma-Gamma model is fit with default options. If argument
<code>newdata</code> is provided, the spending model is fit on <code>newdata</code>. Predicting spending is only possible if
the transaction data contains spending information. See examples for illustrations of valid inputs.</p>
<p>The <code>newdata</code> argument has to be a clv data object of the exact same class as the data object
on which the model was fit. In case the model was fit with covariates, <code>newdata</code> needs to contain identically
named covariate data.</p>
<p>The use case for <code>newdata</code> is mainly two-fold: First, to estimate model parameters only on a
sample of the data and then use the fitted model object to predict or plot for the full data set provided through <code>newdata</code>.
Second, for models with dynamic covariates, to provide a clv data object with longer covariates than contained in the data
on which the model was estimated what allows to predict or plot further. When providing <code>newdata</code>, some models
might require additional steps that can significantly increase runtime.</p>
<p>To predict for new customers, the output of <a href="newcustomer.html">newcustomer</a> has to be given to <code>newdata</code>. See examples.</p>
<p><code>prediction.end</code> indicates until when to predict or plot and can be given as either
a point in time (of class <code>Date</code>, <code>POSIXct</code>, or <code>character</code>) or the number of periods.
If <code>prediction.end</code> is of class character, the date/time format set when creating the data object is used for parsing.
If <code>prediction.end</code> is the number of periods, the end of the fitting period serves as the reference point
from which periods are counted. Only full periods may be specified.
If <code>prediction.end</code> is omitted or NULL, it defaults to the end of the holdout period if present and to the
end of the estimation period otherwise.</p>
<p>The first prediction period is defined to start right after the end of the estimation period.
If for example weekly time units are used and the estimation period ends on Sunday 2019-01-01, then the first day
of the first prediction period is Monday 2019-01-02. Each prediction period includes a total of 7 days and
the first prediction period therefore will end on, and include, Sunday 2019-01-08. Subsequent prediction periods
again start on Mondays and end on Sundays.
If <code>prediction.end</code> indicates a timepoint on which to end, this timepoint is included in the prediction period.</p>
<p><code>continuous.discount.factor</code> is the continuous rate used to discount the expected residual
transactions (<code>DERT/DECT</code>). An annual rate of (100 x d)% equals a continuous rate delta = ln(1+d).
To account for time units which are not annual, the continuous rate has to be further adjusted
to delta=ln(1+d)/k, where k are the number of time units in a year.</p>
    </div>
    <div id="uncertainty-estimates">
    <h2>Uncertainty Estimates</h2>


<p>Bootstrapping is used to provide confidence intervals of all predicted metrics.
These provide an estimate of parameter uncertainty.
To create bootstrapped data, customer ids are sampled with replacement until reaching original
length and all transactions of the sampled customers are used to create a new <code>clv.data</code> object.
A new model is fit on the bootstrapped data with the exact same specification as used when
fitting <code>object</code> (incl. start parameters and `optimx.args`) and it is then used to predict on this data.</p>
<p>It is highly recommended to fit the original model (<code>object</code>) with a robust optimization
method, such as Nelder-Mead (<code>optimx.args=list(method='Nelder-Mead')</code>).
This ensures that the model can also be fit on the bootstrapped data.</p>
<p>All prediction parameters, incl <code>prediction.end</code> and <code>continuous.discount.factor</code>, are forwarded
to the prediction on the bootstrapped data.
Per customer, the boundaries of the confidence intervals of each predicted metric are the
sample quantiles (<code>quantile(x, probs=c((1-level)/2, 1-(1-level)/2)</code>).</p>
<p>See <a href="clv.bootstrapped.apply.html">clv.bootstrapped.apply</a> to create a custom bootstrapping procedure.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>models to predict transactions: <a href="pnbd.html">pnbd</a>, <a href="bgnbd.html">bgnbd</a>, <a href="ggomnbd.html">ggomnbd</a>.</p>
<p>models to predict spending: <a href="gg.html">gg</a>.</p>
<p><code><a href="predict.clv.fitted.spending.html">predict</a></code> for spending models</p>
<p><a href="clv.bootstrapped.apply.html">clv.bootstrapped.apply</a> for bootstrapped model estimation</p>
<p><code><a href="newcustomer.html">newcustomer</a></code> to create data to predict for newly alive customers.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelTrans"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Fit pnbd standard model on data, WITH holdout</span></span></span>
<span class="r-in"><span><span class="va">apparel.holdout</span> <span class="op">&lt;-</span> <span class="fu"><a href="clvdata.html">clvdata</a></span><span class="op">(</span><span class="va">apparelTrans</span>, time.unit<span class="op">=</span><span class="st">"w"</span>,</span></span>
<span class="r-in"><span>                           estimation.split<span class="op">=</span><span class="fl">52</span>, date.format<span class="op">=</span><span class="st">"ymd"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">apparel.pnbd</span> <span class="op">&lt;-</span> <span class="fu"><a href="pnbd.html">pnbd</a></span><span class="op">(</span><span class="va">apparel.holdout</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict until the end of the holdout period</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2010-12-20 (259.14 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2010-12-20      259.1429        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2010-12-20      259.1429        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2010-12-20      259.1429        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2010-12-20      259.1429        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending    PAlive      CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;     &lt;num&gt;    &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                 524.10 0.9162891 4.081243 0.21733995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                  63.31 0.8411075 3.746377 0.19950721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                 333.35 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                   0.00 0.8946137 3.984698 0.21219864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                   0.00 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                 113.80 0.9400738 4.187182 0.22298158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                 253.61 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                   0.00 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                   0.00 0.9655367 4.300596 0.22902127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                  13.99 0.9384834 5.991230 0.31905325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.mean.spending predicted.period.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        &lt;num&gt;                     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                63.77959                 260.30000     13.861854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                38.10316                 142.74877      7.601854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                37.12434                  61.61878      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                33.08404                 131.82992      7.020388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                37.12434                  61.61878      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                28.29614                 118.48111      6.309519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                37.12434                  61.61878      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                37.12434                  61.61878      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                34.87739                 149.99357      7.987664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                16.11315                  96.53757      5.140952</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict until 10 periods (weeks in this case) after</span></span></span>
<span class="r-in"><span><span class="co">#   the end of the 37 weeks fitting period</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">apparel.pnbd</span>, prediction.end <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># ends on 2010-11-28</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2006-03-12 (10 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;int&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2006-03-12            10        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2006-03-12            10        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending    PAlive        CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;     &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                 131.07 0.9162891 0.21100460 0.21733995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                   0.00 0.8411075 0.19369167 0.19950721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                   0.00 0.6575400 0.08581316 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                   0.00 0.8946137 0.20601315 0.21219864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                   0.00 0.6575400 0.08581316 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                   0.00 0.9400738 0.21648178 0.22298158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                   0.00 0.6575400 0.08581316 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                   0.00 0.6575400 0.08581316 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                   0.00 0.9655367 0.22234542 0.22902127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                   0.00 0.9384834 0.30975300 0.31905325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.mean.spending predicted.period.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        &lt;num&gt;                     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                63.77959                 13.457787     13.861854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                38.10316                  7.380264      7.601854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                37.12434                  3.185757      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                33.08404                  6.815748      7.020388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                37.12434                  3.185757      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                28.29614                  6.125599      6.309519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                37.12434                  3.185757      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                37.12434                  3.185757      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                34.87739                  7.754827      7.987664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                16.11315                  4.991095      5.140952</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict until 31th Dec 2016 with the timepoint as a character</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">apparel.pnbd</span>, prediction.end <span class="op">=</span> <span class="st">"2016-12-31"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2016-12-31 (573.86 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length    PAlive       CET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2016-12-31      573.8571 0.9162891  7.439917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2016-12-31      573.8571 0.8411075  6.829472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2016-12-31      573.8571 0.6575400  3.025729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2016-12-31      573.8571 0.8946137  7.263921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2016-12-31      573.8571 0.6575400  3.025729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2016-12-31      573.8571 0.9400738  7.633040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2016-12-31      573.8571 0.6575400  3.025729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2016-12-31      573.8571 0.6575400  3.025729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2016-12-31      573.8571 0.9655367  7.839788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2016-12-31      573.8571 0.9384834 10.921736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            DERT predicted.mean.spending predicted.period.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;num&gt;                   &lt;num&gt;                     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 0.21733995                63.77959                  474.5149     13.861854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 0.19950721                38.10316                  260.2244      7.601854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 0.08838968                37.12434                  112.3282      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 0.21219864                33.08404                  240.3199      7.020388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 0.08838968                37.12434                  112.3282      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596: 0.22298158                28.29614                  215.9856      6.309519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597: 0.08838968                37.12434                  112.3282      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598: 0.08838968                37.12434                  112.3282      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599: 0.22902127                34.87739                  273.4313      7.987664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600: 0.31905325                16.11315                  175.9835      5.140952</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict until 31th Dec 2016 with the timepoint as a Date</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">apparel.pnbd</span>, prediction.end <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html" class="external-link">ymd</a></span><span class="op">(</span><span class="st">"2016-12-31"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2016-12-31 (573.86 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length    PAlive       CET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2016-12-31      573.8571 0.9162891  7.439917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2016-12-31      573.8571 0.8411075  6.829472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2016-12-31      573.8571 0.6575400  3.025729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2016-12-31      573.8571 0.8946137  7.263921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2016-12-31      573.8571 0.6575400  3.025729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2016-12-31      573.8571 0.9400738  7.633040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2016-12-31      573.8571 0.6575400  3.025729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2016-12-31      573.8571 0.6575400  3.025729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2016-12-31      573.8571 0.9655367  7.839788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2016-12-31      573.8571 0.9384834 10.921736</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            DERT predicted.mean.spending predicted.period.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;num&gt;                   &lt;num&gt;                     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 0.21733995                63.77959                  474.5149     13.861854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 0.19950721                38.10316                  260.2244      7.601854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 0.08838968                37.12434                  112.3282      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 0.21219864                33.08404                  240.3199      7.020388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 0.08838968                37.12434                  112.3282      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596: 0.22298158                28.29614                  215.9856      6.309519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597: 0.08838968                37.12434                  112.3282      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598: 0.08838968                37.12434                  112.3282      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599: 0.22902127                34.87739                  273.4313      7.987664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600: 0.31905325                16.11315                  175.9835      5.140952</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict future transactions but not spending and CLV</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">apparel.pnbd</span>, predict.spending <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2010-12-20 (259.14 Weeks).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2010-12-20      259.1429        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2010-12-20      259.1429        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2010-12-20      259.1429        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2010-12-20      259.1429        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending    PAlive      CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;     &lt;num&gt;    &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                 524.10 0.9162891 4.081243 0.21733995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                  63.31 0.8411075 3.746377 0.19950721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                 333.35 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                   0.00 0.8946137 3.984698 0.21219864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                   0.00 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                 113.80 0.9400738 4.187182 0.22298158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                 253.61 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                   0.00 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                   0.00 0.9655367 4.300596 0.22902127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                  13.99 0.9384834 5.991230 0.31905325</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict spending by fitting a Gamma-Gamma model</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">apparel.pnbd</span>, predict.spending <span class="op">=</span> <span class="va">gg</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2010-12-20 (259.14 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2010-12-20      259.1429        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2010-12-20      259.1429        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2010-12-20      259.1429        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2010-12-20      259.1429        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending    PAlive      CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;     &lt;num&gt;    &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                 524.10 0.9162891 4.081243 0.21733995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                  63.31 0.8411075 3.746377 0.19950721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                 333.35 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                   0.00 0.8946137 3.984698 0.21219864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                   0.00 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                 113.80 0.9400738 4.187182 0.22298158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                 253.61 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                   0.00 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                   0.00 0.9655367 4.300596 0.22902127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                  13.99 0.9384834 5.991230 0.31905325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.mean.spending predicted.period.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        &lt;num&gt;                     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                63.77959                 260.30000     13.861854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                38.10316                 142.74877      7.601854</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                37.12434                  61.61878      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                33.08404                 131.82992      7.020388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                37.12434                  61.61878      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                28.29614                 118.48111      6.309519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                37.12434                  61.61878      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                37.12434                  61.61878      3.281408</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                34.87739                 149.99357      7.987664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                16.11315                  96.53757      5.140952</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a spending model separately and use it to predict spending</span></span></span>
<span class="r-in"><span><span class="va">apparel.gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="gg.html">gg</a></span><span class="op">(</span><span class="va">apparel.holdout</span>, remove.first.transaction <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">apparel.pnbd</span>, predict.spending <span class="op">=</span> <span class="va">apparel.gg</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2010-12-20 (259.14 Weeks).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2010-12-20      259.1429        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2010-12-20      259.1429        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2010-12-20      259.1429        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2010-12-20      259.1429        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending    PAlive      CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;     &lt;num&gt;    &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                 524.10 0.9162891 4.081243 0.21733995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                  63.31 0.8411075 3.746377 0.19950721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                 333.35 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                   0.00 0.8946137 3.984698 0.21219864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                   0.00 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                 113.80 0.9400738 4.187182 0.22298158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                 253.61 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                   0.00 0.6575400 1.659795 0.08838968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                   0.00 0.9655367 4.300596 0.22902127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                  13.99 0.9384834 5.991230 0.31905325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.mean.spending predicted.period.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        &lt;num&gt;                     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:               136.73183                 558.03579     29.717289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                29.00428                 108.66095      5.786562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                48.90849                  81.17806      4.323006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                31.76895                 126.58969      6.741328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                77.59707                 128.79522      6.858780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                21.67439                  90.75460      4.832989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                45.64301                  75.75803      4.034371</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                29.53283                  49.01844      2.610398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                32.46527                 139.62002      7.435238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                22.06995                 132.22615      7.041489</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit pnbd standard model WITHOUT holdout</span></span></span>
<span class="r-in"><span><span class="va">pnc</span> <span class="op">&lt;-</span> <span class="fu"><a href="pnbd.html">pnbd</a></span><span class="op">(</span><span class="fu"><a href="clvdata.html">clvdata</a></span><span class="op">(</span><span class="va">apparelTrans</span>, time.unit<span class="op">=</span><span class="st">"w"</span>, date.format<span class="op">=</span><span class="st">"ymd"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This fails, because without holdout, a prediction.end is required</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">pnc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But it works if providing a prediction.end</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">pnc</span>, prediction.end <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># ends on 2016-12-17</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2010-12-21 until (incl.) 2011-02-28 (10 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length      PAlive         CET</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;int&gt;       &lt;num&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2010-12-21  2011-02-28            10 0.007191623 0.001466915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2010-12-21  2011-02-28            10 0.836860928 0.101279050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2010-12-21  2011-02-28            10 0.922281780 0.264629016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2010-12-21  2011-02-28            10 0.053020374 0.003484528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2010-12-21  2011-02-28            10 0.061489323 0.002340870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2010-12-21  2011-02-28            10 0.697534261 0.142279953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2010-12-21  2011-02-28            10 0.551357052 0.066726640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2010-12-21  2011-02-28            10 0.061489323 0.002340870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2010-12-21  2011-02-28            10 0.077985685 0.005125262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2010-12-21  2011-02-28            10 0.065543374 0.007932227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             DERT predicted.mean.spending predicted.period.spending</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt;                   &lt;num&gt;                     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 0.001524793                77.79363                 0.1141167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 0.105275083                36.04491                 3.6505939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 0.275070134                37.23417                 9.8532412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 0.003622012                36.01842                 0.1255072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 0.002433231                37.73097                 0.0883233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596: 0.147893705                28.17770                 4.0091225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597: 0.069359385                59.20915                 3.9508274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598: 0.002433231                37.73097                 0.0883233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599: 0.005327482                36.71922                 0.1881956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600: 0.008245198                25.00120                 0.1983152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:    0.11861922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:    3.79463052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:   10.24200757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    0.13045916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    0.09180815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:    4.16730515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:    4.10671002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:    0.09180815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:    0.19562100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:    0.20613989</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict the number of transactions a single, fictional, average new</span></span></span>
<span class="r-in"><span><span class="co"># customer is expected to make in the first 3.45 weeks since coming alive</span></span></span>
<span class="r-in"><span><span class="co"># See ?newcustomer() for more examples</span></span></span>
<span class="r-in"><span><span class="fu">predict</span><span class="op">(</span><span class="va">apparel.pnbd</span>, newdata <span class="op">=</span> <span class="fu"><a href="newcustomer.html">newcustomer</a></span><span class="op">(</span>num.periods<span class="op">=</span><span class="fl">3.45</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09627075</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Bachmann, Niels Kuebler, Markus Meierer, Jeffrey Naef, E. Shin Oblander, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

