<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pareto/NBD models — pnbd • CLVTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Pareto/NBD models — pnbd" />
<meta property="og:description" content="Fits Pareto/NBD models on transactional data with and without covariates." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLVTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CLVTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/internal_docu/internal_docu.html">Internal Package Documentation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bachmannpatrick/CLVTools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pareto/NBD models</h1>
    <small class="dont-index">Source: <a href='https://github.com/bachmannpatrick/CLVTools/blob/master/R/f_interface_pnbd.R'><code>R/f_interface_pnbd.R</code></a></small>
    <div class="hidden name"><code>pnbd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits Pareto/NBD models on transactional data with and without covariates.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for clv.data</span>
<span class='fu'>pnbd</span>(
  <span class='no'>clv.data</span>,
  <span class='kw'>start.params.model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>use.cor</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>start.param.cor</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)

<span class='co'># S4 method for clv.data.static.covariates</span>
<span class='fu'>pnbd</span>(
  <span class='no'>clv.data</span>,
  <span class='kw'>start.params.model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>use.cor</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>start.param.cor</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>names.cov.life</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>names.cov.trans</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>start.params.life</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>start.params.trans</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>names.cov.constr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>start.params.constr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>reg.lambdas</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='no'>...</span>
)

<span class='co'># S4 method for clv.data.dynamic.covariates</span>
<span class='fu'>pnbd</span>(
  <span class='no'>clv.data</span>,
  <span class='kw'>start.params.model</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>use.cor</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>start.param.cor</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>optimx.args</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(),
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>names.cov.life</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>names.cov.trans</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>start.params.life</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>start.params.trans</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>names.cov.constr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>start.params.constr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='kw'>reg.lambdas</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>clv.data</th>
      <td><p>The data object on which the model is fitted.</p></td>
    </tr>
    <tr>
      <th>start.params.model</th>
      <td><p>Named start parameters containing the optimization start parameters for the model without covariates.</p></td>
    </tr>
    <tr>
      <th>use.cor</th>
      <td><p>Whether the correlation between the transaction and lifetime process should be estimated.</p></td>
    </tr>
    <tr>
      <th>start.param.cor</th>
      <td><p>Start parameter for the optimization of the correlation.</p></td>
    </tr>
    <tr>
      <th>optimx.args</th>
      <td><p>Additional arguments to control the optimization which are forwarded to <code><a href='https://rdrr.io/pkg/optimx/man/optimx.html'>optimx::optimx</a></code>.
If multiple optimization methods are specified, only the result of the last method is further processed.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show details about the running of the function.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Ignored</p></td>
    </tr>
    <tr>
      <th>names.cov.life</th>
      <td><p>Which of the set Lifetime covariates should be used. Missing parameter indicates all covariates shall be used.</p></td>
    </tr>
    <tr>
      <th>names.cov.trans</th>
      <td><p>Which of the set Transaction covariates should be used. Missing parameter indicates all covariates shall be used.</p></td>
    </tr>
    <tr>
      <th>start.params.life</th>
      <td><p>Named start parameters containing the optimization start parameters for all lifetime covariates.</p></td>
    </tr>
    <tr>
      <th>start.params.trans</th>
      <td><p>Named start parameters containing the optimization start parameters for all transaction covariates.</p></td>
    </tr>
    <tr>
      <th>names.cov.constr</th>
      <td><p>Which covariates should be forced to use the same parameters for the lifetime and transaction process. The covariates need to be present as both, lifetime and transaction covariates.</p></td>
    </tr>
    <tr>
      <th>start.params.constr</th>
      <td><p>Named start parameters containing the optimization start parameters for the constraint covariates.</p></td>
    </tr>
    <tr>
      <th>reg.lambdas</th>
      <td><p>Named lambda parameters used for the L2 regularization of the lifetime and the transaction covariate parameters. Lambdas have to be &gt;= 0.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Depending on the data object on which the model was fit, <code>pnbd</code> returns either an object of
class <a href='clv.pnbd-class.html'>clv.pnbd</a>, <a href='clv.pnbd.static.cov-class.html'>clv.pnbd.static.cov</a>, or <a href='clv.pnbd.dynamic.cov-class.html'>clv.pnbd.dynamic.cov</a>.</p>
<p>The function <code><a href='summary.clv.fitted.html'>summary</a></code> can be used to obtain and print a summary of the results.
The generic accessor functions <code>coefficients</code>, <code><a href='vcov.clv.fitted.html'>vcov</a></code>, <code><a href='fitted.clv.fitted.html'>fitted</a></code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>, and <code>nobs</code> are available.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Model parameters for the Pareto/NBD model are <code>alpha, r, beta, and s</code>. <br />
<code>s</code>: shape parameter of the Gamma distribution for the lifetime process.
The smaller s, the stronger the heterogeneity of customer lifetimes. <br />
<code>beta</code>: scale parameter for the Gamma distribution for the lifetime process. <br />
<code>r</code>: shape parameter of the Gamma distribution of the purchase process.
The smaller r, the stronger the heterogeneity of the purchase process.<br />
<code>alpha</code>: scale parameter of the Gamma distribution of the purchase process.</p>
<p>Ideally, the starting parameters for r and s represent your best guess
concerning the heterogeneity of customers in their buy and die rate.
If covariates are included into the model additionally parameters for the
covariates affecting the attrition and the purchase process are part of the model.</p>
<p>If no start parameters are given, 1.0 is used for all model parameters and 0.1 for covariate parameters.
The model start parameters are required to be &gt; 0.</p>
<h3>The Pareto/NBD model</h3>
<p>The Pareto/NBD was the first model addressing the issue of modeling customer purchases and
attrition simultaneously for non-contractual settings. The model uses a Pareto distribution,
a combination of an Exponential and a Gamma distribution, to explicitly model customers'
(unobserved) attrition behavior in addition to customers' purchase process.<br />
In general, the Pareto/NBD model consist of two parts. A first process models the purchase
behavior of customers as long as the customers are active. A second process models customers'
attrition. Customers live (and buy) for a certain unknown time until they become inactive
and "die". Customer attrition is unobserved. Inactive customers may not be reactivated.
For technical details we refer to the original paper by Schmittlein, Morrison and Colombo
(1987) and the detailed technical note of Fader and Hardie (2005).</p>

<h3>Pareto/NBD model with static covariates</h3>
<p>The standard Pareto/NBD model captures heterogeneity was solely using Gamma distributions.
However, often exogenous knowledge, such as for example customer demographics, is available.
The supplementary knowledge may explain part of the heterogeneity among the customers and
therefore increase the predictive accuracy of the model. In addition, we can rely on these
parameter estimates for inference, i.e. identify and quantify effects of contextual factors
on the two underlying purchase and attrition processes. For technical details we refer to
the technical note by Fader and Hardie (2007).</p>

<h3>Pareto/NBD model with dynamic covariates</h3>
<p>In many real-world applications customer purchase and attrition behavior may be
influenced by covariates that vary over time. In consequence, the timing of a purchase
and the corresponding value of at covariate a that time becomes relevant. Time-varying
covariates can affect customer on aggregated level as well as on an individual level:
In the first case, all customers are affected simultaneously, in the latter case a
covariate is only relevant for a particular customer. For technical details we refer to
the paper by Bachmann, Meierer and Näf (2019).</p>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Fitting the Pareto/NBD model with dynamic covariates is for the most part implemented using <code>data.table</code> and to a smaller part further
parallelized with the <code>foreach</code> package. Registering a
parallel backend with <code><a href='https://rdrr.io/pkg/doFuture/man/doFuture.html'>doFuture</a></code> or <code><a href='https://rdrr.io/pkg/doParallel/man/doParallel-package.html'>doParallel</a></code> before fitting the
models allows to take advantage of this. If no parallel backend is set up, the <code>foreach</code> package gives a friendly reminder that
it is executed sequentially. In case this is desired but no warning should be given, a parallel backend in sequential mode
can be set up, for example package <code>doFuture</code> with <code><a href='https://rdrr.io/pkg/future/man/plan.html'>plan("sequential")</a></code>.</p>
<p>The part executed with <code>foreach</code> also heavily relies on <code>data.table</code> which is natively parallelized already. When setting up
the parallel backend, great care should be taken to reduce the overhead from this nested parallelism as otherwise it can <em>increase</em> runtime.
See <code><a href='https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html'>setDTthreads</a></code>, <code><a href='https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html'>getDTthreads</a></code>,
and <code><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></code> for information on how to do this.</p>
<p>The Pareto/NBD model with dynamic covariates can currently not be fit with data that has a temporal resolution
of less than one day (data that was built with time unit <code>hours</code>).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Schmittlein DC, Morrison DG, Colombo R (1987). “Counting Your Customers: 
Who-Are They and What Will They Do Next?” Management Science, 33(1), 1–24.</p>
<p>Fader PS, Hardie BGS (2005). “A Note on Deriving the Pareto/NBD Model and 
Related Expressions.” 
URL http://www.brucehardie.com/notes/009/pareto_nbd_derivations_ 2005-11-05.pdf.</p>
<p>Fader PS, Hardie BG (2007). "Incorporating time-invariant covariates into the 
Pareto/NBD and BG/NBD models." 
URL http://www.brucehardie.com/notes/019/time_invariant_ covariates.pdf.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='clvdata.html'>clvdata</a></code> to create a clv data object, <code><a href='SetStaticCovariates.html'>SetStaticCovariates</a></code> and <code><a href='SetDynamicCovariates.html'>SetDynamicCovariates</a></code>
to add static or dynamic covariates to an existing clv data object on which then the <code>pnbd</code> method can be fit</p>
<p><code><a href='predict.clv.fitted.html'>predict</a></code> to predict expected transactions, probability of being alive, and customer lifetime value for every customer</p>
<p><code><a href='plot.clv.fitted.html'>plot</a></code> to plot the unconditional expectation as predicted by the fitted model</p>
<p>The generic functions <code><a href='vcov.clv.fitted.html'>vcov</a></code>, <code><a href='summary.clv.fitted.html'>summary</a></code>, <code><a href='fitted.clv.fitted.html'>fitted</a></code>.</p>
<p><code><a href='https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html'>setDTthreads</a></code>, <code><a href='https://Rdatatable.gitlab.io/data.table/reference/openmp-utils.html'>getDTthreads</a></code>,<code><a href='https://rdrr.io/pkg/doParallel/man/registerDoParallel.html'>registerDoParallel</a></code>,<code><a href='https://rdrr.io/pkg/doFuture/man/registerDoFuture.html'>registerDoFuture</a></code> for setting up parallel execution.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Patrick Bachmann, Jeffrey Naef, Patrik Schilter, Markus Meierer, Niels Kuebler.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


