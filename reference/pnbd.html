<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pareto/NBD models — pnbd • CLVTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Pareto/NBD models — pnbd"><meta property="og:description" content="Fits Pareto/NBD models on transactional data with and without covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-2');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLVTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/CLVTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/internal_docu/internal_docu.html">UNKNOWN TITLE</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bachmannpatrick/CLVTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pareto/NBD models</h1>
    <small class="dont-index">Source: <a href="https://github.com/bachmannpatrick/CLVTools/blob/master/R/f_interface_pnbd.R" class="external-link"><code>R/f_interface_pnbd.R</code></a></small>
    <div class="hidden name"><code>pnbd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits Pareto/NBD models on transactional data with and without covariates.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for clv.data</span>
<span class="fu">pnbd</span><span class="op">(</span>
  <span class="va">clv.data</span>,
  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,
  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S4 method for clv.data.static.covariates</span>
<span class="fu">pnbd</span><span class="op">(</span>
  <span class="va">clv.data</span>,
  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,
  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  start.params.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  names.cov.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="co"># S4 method for clv.data.dynamic.covariates</span>
<span class="fu">pnbd</span><span class="op">(</span>
  <span class="va">clv.data</span>,
  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,
  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>,
  names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  start.params.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  names.cov.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    

<dl><dt>clv.data</dt><dd><p>The data object on which the model is fitted.</p></dd>
</dl><dl><dt>start.params.model</dt><dd><p>Named start parameters containing the optimization start parameters for the model without covariates.</p></dd>
</dl><dl><dt>use.cor</dt><dd><p>Whether the correlation between the transaction and lifetime process should be estimated.</p></dd>
</dl><dl><dt>start.param.cor</dt><dd><p>Start parameter for the optimization of the correlation.</p></dd>
</dl><dl><dt>optimx.args</dt><dd><p>Additional arguments to control the optimization which are forwarded to <code><a href="https://rdrr.io/pkg/optimx/man/optimx.html" class="external-link">optimx::optimx</a></code>.
If multiple optimization methods are specified, only the result of the last method is further processed.</p></dd>
</dl><dl><dt>verbose</dt><dd><p>Show details about the running of the function.</p></dd>
</dl><dl><dt>...</dt><dd><p>Ignored</p></dd>
</dl><dl><dt>names.cov.life</dt><dd><p>Which of the set Lifetime covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>
</dl><dl><dt>names.cov.trans</dt><dd><p>Which of the set Transaction covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>
</dl><dl><dt>start.params.life</dt><dd><p>Named start parameters containing the optimization start parameters for all lifetime covariates.</p></dd>
</dl><dl><dt>start.params.trans</dt><dd><p>Named start parameters containing the optimization start parameters for all transaction covariates.</p></dd>
</dl><dl><dt>names.cov.constr</dt><dd><p>Which covariates should be forced to use the same parameters for the lifetime and transaction process. The covariates need to be present as both, lifetime and transaction covariates.</p></dd>
</dl><dl><dt>start.params.constr</dt><dd><p>Named start parameters containing the optimization start parameters for the constraint covariates.</p></dd>
</dl><dl><dt>reg.lambdas</dt><dd><p>Named lambda parameters used for the L2 regularization of the lifetime and the transaction covariate parameters. Lambdas have to be &gt;= 0.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Depending on the data object on which the model was fit, <code>pnbd</code> returns either an object of
class <a href="clv.pnbd-class.html">clv.pnbd</a>, <a href="clv.pnbd.static.cov-class.html">clv.pnbd.static.cov</a>, or <a href="clv.pnbd.dynamic.cov-class.html">clv.pnbd.dynamic.cov</a>.</p>
<p>The function <code><a href="summary.clv.fitted.html">summary</a></code> can be used to obtain and print a summary of the results.
The generic accessor functions <code>coefficients</code>, <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>, and <code>nobs</code> are available.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Model parameters for the Pareto/NBD model are <code>alpha, r, beta, and s</code>. <br><code>s</code>: shape parameter of the Gamma distribution for the lifetime process.
The smaller s, the stronger the heterogeneity of customer lifetimes. <br><code>beta</code>: rate parameter for the Gamma distribution for the lifetime process. <br><code>r</code>: shape parameter of the Gamma distribution of the purchase process.
The smaller r, the stronger the heterogeneity of the purchase process.<br><code>alpha</code>: rate parameter of the Gamma distribution of the purchase process.</p>
<p>Based on these parameters, the average purchase rate while customers are active
is r/alpha and the average dropout rate is s/beta.</p>
<p>Ideally, the starting parameters for r and s represent your best guess
concerning the heterogeneity of customers in their buy and die rate.
If covariates are included into the model additionally parameters for the
covariates affecting the attrition and the purchase process are part of the model.</p>
<p>If no start parameters are given, 1.0 is used for all model parameters and 0.1 for covariate parameters.
The model start parameters are required to be &gt; 0.</p>
<div class="section">
<h3 id="the-pareto-nbd-model">The Pareto/NBD model<a class="anchor" aria-label="anchor" href="#the-pareto-nbd-model"></a></h3>
<p>The Pareto/NBD is the first model addressing the issue of modeling customer purchases and
attrition simultaneously for non-contractual settings. The model uses a Pareto distribution,
a combination of an Exponential and a Gamma distribution, to explicitly model customers'
(unobserved) attrition behavior in addition to customers' purchase process.<br>
In general, the Pareto/NBD model consist of two parts. A first process models the purchase
behavior of customers as long as the customers are active. A second process models customers'
attrition. Customers live (and buy) for a certain unknown time until they become inactive
and "die". Customer attrition is unobserved. Inactive customers may not be reactivated.
For technical details we refer to the original paper by Schmittlein, Morrison and Colombo
(1987) and the detailed technical note of Fader and Hardie (2005).</p>
</div>

<div class="section">
<h3 id="pareto-nbd-model-with-static-covariates">Pareto/NBD model with static covariates<a class="anchor" aria-label="anchor" href="#pareto-nbd-model-with-static-covariates"></a></h3>
<p>The standard Pareto/NBD model captures heterogeneity was solely using Gamma distributions.
However, often exogenous knowledge, such as for example customer demographics, is available.
The supplementary knowledge may explain part of the heterogeneity among the customers and
therefore increase the predictive accuracy of the model. In addition, we can rely on these
parameter estimates for inference, i.e. identify and quantify effects of contextual factors
on the two underlying purchase and attrition processes. For technical details we refer to
the technical note by Fader and Hardie (2007).</p>
</div>

<div class="section">
<h3 id="pareto-nbd-model-with-dynamic-covariates">Pareto/NBD model with dynamic covariates<a class="anchor" aria-label="anchor" href="#pareto-nbd-model-with-dynamic-covariates"></a></h3>
<p>In many real-world applications customer purchase and attrition behavior may be
influenced by covariates that vary over time. In consequence, the timing of a purchase
and the corresponding value of at covariate a that time becomes relevant. Time-varying
covariates can affect customer on aggregated level as well as on an individual level:
In the first case, all customers are affected simultaneously, in the latter case a
covariate is only relevant for a particular customer. For technical details we refer to
the paper by Bachmann, Meierer and Näf (2020).</p>
</div>

    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The Pareto/NBD model with dynamic covariates can currently not be fit with data that has a temporal resolution
of less than one day (data that was built with time unit <code>hours</code>).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Schmittlein DC, Morrison DG, Colombo R (1987). “Counting Your Customers:
Who-Are They and What Will They Do Next?” Management Science, 33(1), 1–24.</p>
<p>Fader PS, Hardie BGS (2005). “A Note on Deriving the Pareto/NBD Model and
Related Expressions.”
URL <a href="http://www.brucehardie.com/notes/009/pareto_nbd_derivations_2005-11-05.pdf" class="external-link">http://www.brucehardie.com/notes/009/pareto_nbd_derivations_2005-11-05.pdf</a>.</p>
<p>Fader PS, Hardie BG (2007). “Incorporating time-invariant covariates into the
Pareto/NBD and BG/NBD models.”
URL <a href="http://www.brucehardie.com/notes/019/time_invariant_covariates.pdf" class="external-link">http://www.brucehardie.com/notes/019/time_invariant_covariates.pdf</a>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="clvdata.html">clvdata</a></code> to create a clv data object, <code><a href="SetStaticCovariates.html">SetStaticCovariates</a></code>
to add static covariates to an existing clv data object.</p>
<p><code><a href="predict.clv.fitted.transactions.html">predict</a></code> to predict expected transactions, probability of being alive, and customer lifetime value for every customer</p>
<p><code><a href="plot.clv.fitted.transactions.html">plot</a></code> to plot the unconditional expectation as predicted by the fitted model</p>
<p>The generic functions <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="summary.clv.fitted.html">summary</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>.</p>
<p><code><a href="SetDynamicCovariates.html">SetDynamicCovariates</a></code> to add dynamic covariates on which the <code>pnbd</code> model can be fit.</p></div>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelTrans"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">clv.data.apparel</span> <span class="op">&lt;-</span> <span class="fu"><a href="clvdata.html">clvdata</a></span><span class="op">(</span><span class="va">apparelTrans</span>, date.format <span class="op">=</span> <span class="st">"ymd"</span>,</span>
<span class="r-in">                            time.unit <span class="op">=</span> <span class="st">"w"</span>, estimation.split <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Fit standard pnbd model</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       r    alpha        s     beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7866   5.3349   0.3570  11.6152  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Give initial guesses for the model parameters</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span>
<span class="r-in">     start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">15</span>, s<span class="op">=</span><span class="fl">0.5</span>, beta<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, start.params.model = c(r = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alpha = 15, s = 0.5, beta = 10))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       r    alpha        s     beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7858   5.3312   0.3606  11.8221  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># pass additional parameters to the optimizer (optimx)</span></span>
<span class="r-in"><span class="co">#    Use Nelder-Mead as optimization method and print</span></span>
<span class="r-in"><span class="co">#    detailed information about the optimization process</span></span>
<span class="r-in"><span class="va">apparel.pnbd</span> <span class="op">&lt;-</span> <span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span>
<span class="r-in">                     optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span>
<span class="r-in">                                        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn is  fn </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Looking for method =  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Methods to be used:[1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optcfg:$fname</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fn"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $npar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$follow.on</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$save.failures</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$trace</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$all.methods</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$starttests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$maximize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$dowarn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkttol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt2tol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$badval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.988466e+307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$scaletol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ufn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (LL.params, LL.param.names.to.optimx, LL.function.sum, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     use.interlayer.constr, use.interlayer.reg, reg.lambda.trans, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     reg.lambda.life, use.cor, ...) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     all.other.args &lt;- list(...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     names(LL.params) &lt;- LL.param.names.to.optimx</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     interlayers.to.use &lt;- list(callLL = interlayer_callLL)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (use.cor == T &amp; !anyNA(use.cor)) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         interlayers.to.use &lt;- c(correlation = interlayer_correlation, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             interlayers.to.use)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (use.interlayer.reg == T &amp; !is.null(reg.lambda.trans) &amp; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         !anyNA(reg.lambda.trans) &amp; !is.null(reg.lambda.life) &amp; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         !anyNA(reg.lambda.life)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         interlayers.to.use &lt;- c(regularization = interlayer_regularization, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             interlayers.to.use)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     if (use.interlayer.constr == TRUE) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         interlayers.to.use &lt;- c(constraints = interlayer_constraints, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             interlayers.to.use)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     interlayer.call.args &lt;- list(next.interlayers = interlayers.to.use, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         LL.function.sum = LL.function.sum, LL.params = LL.params, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         reg.lambda.life = reg.lambda.life, reg.lambda.trans = reg.lambda.trans)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     interlayer.call.args &lt;- modifyList(interlayer.call.args, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         all.other.args)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     return(do.call(what = interlayer_callnextinterlayer, args = interlayer.call.args))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x7fa98b1d4d30&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: namespace:CLVTools&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Nelder-Mead direct search function minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function value for initial parameters = 3324.183952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Scaled convergence tolerance is 4.95342e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stepsize computed as 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BUILD              5 3370.858623 3309.338871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION          7 3349.894066 3246.484880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION       9 3324.183952 3246.484880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         11 3311.326140 3192.670595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         13 3309.338871 3136.995127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         15 3246.890840 3070.661973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      17 3246.484880 3070.661973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         19 3192.670595 2962.711423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      21 3136.995127 2962.711423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      23 3092.779244 2962.711423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         25 3070.661973 2904.899192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         27 2979.692293 2901.790592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        29 2971.137892 2896.215344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      31 2962.711423 2890.642122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      33 2906.533400 2890.642122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      35 2904.899192 2890.642122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      37 2901.790592 2890.642122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      39 2896.854291 2890.642122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      41 2896.733398 2890.642122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      43 2896.215344 2890.642122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         45 2895.169640 2884.464824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      47 2891.545912 2884.464824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      49 2890.755169 2884.464824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         51 2890.642122 2882.953045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        53 2888.700681 2882.446051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      55 2884.570203 2882.446051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      57 2884.464824 2882.446051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      59 2883.270678 2882.446051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      61 2882.953045 2882.396690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      63 2882.895319 2882.314190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      65 2882.482512 2882.248928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      67 2882.446051 2882.248928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      69 2882.396690 2882.240024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      71 2882.314190 2882.191572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      73 2882.251157 2882.163573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      75 2882.248928 2882.163573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      77 2882.240024 2882.163573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      79 2882.191572 2882.162231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      81 2882.167468 2882.140209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      83 2882.166824 2882.140209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      85 2882.163573 2882.140209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      87 2882.162231 2882.138172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        89 2882.144473 2882.137304</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      91 2882.141601 2882.135061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      93 2882.140209 2882.132257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        95 2882.138172 2882.129096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         97 2882.137304 2882.117858</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      99 2882.135061 2882.117858</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     101 2882.132257 2882.117858</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        103 2882.129096 2882.106725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        105 2882.126478 2882.091916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     107 2882.119912 2882.091916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     109 2882.117858 2882.091916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        111 2882.106725 2882.071824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     113 2882.104616 2882.071824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        115 2882.099252 2882.044612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        117 2882.091916 2882.012574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     119 2882.079287 2882.012574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        121 2882.071824 2881.969055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        123 2882.044612 2881.898069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     125 2882.032117 2881.898069</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        127 2882.012574 2881.780423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     129 2881.969055 2881.780423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        131 2881.918692 2881.640737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     133 2881.898069 2881.640737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        135 2881.809312 2881.425073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     137 2881.780423 2881.425073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        139 2881.647928 2881.303066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        141 2881.640737 2881.229749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       143 2881.430767 2881.166043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     145 2881.425073 2881.166043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     147 2881.303066 2881.166043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        149 2881.279120 2881.119888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        151 2881.277302 2881.042370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     153 2881.229749 2881.042370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        155 2881.166043 2880.967832</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        157 2881.119888 2880.879994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     159 2881.087359 2880.879994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       161 2881.042370 2880.879853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     163 2880.967832 2880.879853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     165 2880.901343 2880.879853</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     167 2880.882262 2880.869537</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       169 2880.881546 2880.868296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       171 2880.879994 2880.855871</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     173 2880.879853 2880.854640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     175 2880.869537 2880.854640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        177 2880.868296 2880.818013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     179 2880.857420 2880.818013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     181 2880.855871 2880.818013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     183 2880.854640 2880.818013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        185 2880.842474 2880.781988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     187 2880.842315 2880.781988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     189 2880.832743 2880.781988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        191 2880.818013 2880.720303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        193 2880.795624 2880.670354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     195 2880.787343 2880.670354</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        197 2880.781988 2880.617628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        199 2880.720303 2880.439926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     201 2880.680023 2880.439926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        203 2880.670354 2880.358120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        205 2880.617628 2880.277481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        207 2880.473779 2879.924264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     209 2880.439926 2879.924264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     211 2880.358120 2879.924264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     213 2880.277481 2879.924264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        215 2880.105129 2879.758291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        217 2880.090475 2879.608276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     219 2879.960968 2879.608276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     221 2879.924264 2879.608276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     223 2879.758291 2879.608276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       225 2879.713263 2879.550139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     227 2879.630410 2879.550139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        229 2879.610548 2879.511643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     231 2879.608276 2879.511643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       233 2879.568497 2879.480952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     235 2879.550139 2879.480952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     237 2879.526502 2879.480952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     239 2879.511643 2879.480932</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       241 2879.492292 2879.478755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     243 2879.484230 2879.476099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     245 2879.480952 2879.475526</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       247 2879.480932 2879.471443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     249 2879.478755 2879.471443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     251 2879.476099 2879.471443</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     253 2879.475526 2879.471441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     255 2879.473131 2879.470985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     257 2879.472498 2879.470985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     259 2879.471443 2879.470914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     261 2879.471441 2879.470638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       263 2879.471127 2879.470444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     265 2879.470985 2879.470444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     267 2879.470914 2879.470444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     269 2879.470638 2879.470444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       271 2879.470543 2879.470242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     273 2879.470526 2879.470242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        275 2879.470450 2879.470087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     277 2879.470444 2879.470087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     279 2879.470311 2879.470087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     281 2879.470242 2879.470087</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       283 2879.470158 2879.470001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     285 2879.470109 2879.470001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     287 2879.470101 2879.470001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     289 2879.470087 2879.470001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exiting from Nelder Mead minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     291 function evaluations used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post processing for method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Successful convergence! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute Hessian approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute gradient approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Save results from method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     log.r log.alpha     log.s  log.beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.238902  1.675864 -1.030490  2.452082 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2879.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convcode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      291 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nitns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xtimes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> user.self </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assemble the answers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># estimated coefs</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         r     alpha         s      beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.787492  5.343412  0.356832 11.612502 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># summary of the fitted model</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD Standard  Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, optimx.args = list(method = "Nelder-Mead", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = list(trace = 6)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting period:                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation start  2005-01-03   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation end    2005-10-10   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation length 40.0000 Weeks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error z-val Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r       0.7875     0.1326 5.941 2.83e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha   5.3434     0.9039 5.912 3.38e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s       0.3568     0.1833 1.947   0.0515 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta   11.6125    10.6334 1.092   0.2748    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization info:                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LL     -2879.4700 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC    5766.9400  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC    5781.0258  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 1  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 2  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fevals 291.0000   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method Nelder-Mead</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation FALSE</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># predict CLV etc for holdout period</span></span>
<span class="r-in"><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2005-10-11 until (incl.) 2006-07-16 (39.86 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Id period.first period.last period.length actual.x actual.total.spending</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:    1   2005-10-11  2006-07-16      39.85714        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:   10   2005-10-11  2006-07-16      39.85714        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:  100   2005-10-11  2006-07-16      39.85714       23                737.53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 1000   2005-10-11  2006-07-16      39.85714       23               1069.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 1001   2005-10-11  2006-07-16      39.85714       11                364.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246: 1219   2005-10-11  2006-07-16      39.85714       14                413.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247:  122   2005-10-11  2006-07-16      39.85714        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248: 1220   2005-10-11  2006-07-16      39.85714        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249: 1221   2005-10-11  2006-07-16      39.85714        9                302.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250: 1222   2005-10-11  2006-07-16      39.85714        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         PAlive        CET       DERT predicted.mean.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 0.3571652  0.2214654 0.05854369                39.95483      2.339103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 0.4226928  0.9277460 0.24524673                55.23031     13.545053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 0.9156048 13.5446396 3.58048291                43.57390    156.015602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 0.9967799 13.1757590 3.48297048                41.60921    144.923640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 0.5100298  3.5289953 0.93287881                45.58153     42.522040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246: 0.9579466  3.6111037 0.95458391                33.58728     32.061875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247: 0.3571652  0.2214654 0.05854369                39.95483      2.339103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248: 0.3571652  0.2214654 0.05854369                39.95483      2.339103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249: 0.9434610  4.2993712 1.13652527                34.28958     38.970974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250: 0.4137006  0.5822653 0.15391999                47.35500      7.288881</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># predict CLV etc for the next 15 periods</span></span>
<span class="r-in"><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.pnbd</span>, prediction.end <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2005-10-11 until (incl.) 2006-01-23 (15 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Id period.first period.last period.length actual.x actual.total.spending</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:    1   2005-10-11  2006-01-23            15        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:   10   2005-10-11  2006-01-23            15        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:  100   2005-10-11  2006-01-23            15       10                224.71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 1000   2005-10-11  2006-01-23            15       10                343.11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 1001   2005-10-11  2006-01-23            15        6                206.65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246: 1219   2005-10-11  2006-01-23            15       11                325.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247:  122   2005-10-11  2006-01-23            15        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248: 1220   2005-10-11  2006-01-23            15        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249: 1221   2005-10-11  2006-01-23            15        7                158.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250: 1222   2005-10-11  2006-01-23            15        0                  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         PAlive        CET       DERT predicted.mean.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 0.3571652 0.08876335 0.05854369                39.95483      2.339103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 0.4226928 0.37184063 0.24524673                55.23031     13.545053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 0.9156048 5.42869219 3.58048291                43.57390    156.015602</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 0.9967799 5.28084482 3.48297048                41.60921    144.923640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 0.5100298 1.41442148 0.93287881                45.58153     42.522040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246: 0.9579466 1.44733052 0.95458391                33.58728     32.061875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247: 0.3571652 0.08876335 0.05854369                39.95483      2.339103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248: 0.3571652 0.08876335 0.05854369                39.95483      2.339103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249: 0.9434610 1.72318818 1.13652527                34.28958     38.970974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250: 0.4137006 0.23337194 0.15391999                47.35500      7.288881</span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="co"># Estimate correlation as well</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>, use.cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, use.cor = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               r            alpha                s             beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.790394         5.355977         0.278047         7.116957  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cor(life,trans)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -0.009087  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     TRUE </span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="co"># To estimate the pnbd model with static covariates,</span></span>
<span class="r-in"><span class="co">#   add static covariates to the data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelStaticCov"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">clv.data.static.cov</span> <span class="op">&lt;-</span></span>
<span class="r-in"> <span class="fu"><a href="SetStaticCovariates.html">SetStaticCovariates</a></span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span>
<span class="r-in">                     data.cov.life <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span>
<span class="r-in">                     names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span>
<span class="r-in">                     data.cov.trans <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span>
<span class="r-in">                     names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Fit pnbd with static covariates</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.4197        35.5729         0.2727         8.4407         1.5067  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -1.7005         1.4210         0.4022  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Give initial guesses for both covariate parameters</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.75</span>, Channel<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>,</span>
<span class="r-in">                   start.params.life  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span>, Channel<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, start.params.life = c(Gender = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Channel = 0.5), start.params.trans = c(Gender = 0.75, Channel = 0.7))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.4181        35.5968         0.2730         8.6001         1.5230  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -1.7011         1.4227         0.4023  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Use regularization</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="fl">5</span>, life<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, reg.lambdas = c(trans = 5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     life = 5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.7927218      5.4471984      0.3583809     11.6113953     -0.0005224  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.0024106      0.0105961      0.0087095  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  TRUE </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Force the same coefficient to be used for both covariates</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.constr <span class="op">=</span> <span class="st">"Gender"</span>,</span>
<span class="r-in">                   start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, names.cov.constr = "Gender", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     start.params.constr = c(Gender = 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta   life.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1.424         35.470          0.274          7.867         -1.690  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trans.Channel  constr.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.402          1.416  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Fit model only with the Channel covariate for life but</span></span>
<span class="r-in"><span class="co"># keep all trans covariates as is</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, names.cov.life = c("Channel"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta   life.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.4917        32.1539         0.2496         1.7971        -1.6949  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.2723         0.3937  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"><span class="co"># Add dynamic covariates data to the data object</span></span>
<span class="r-in"><span class="co">#   add dynamic covariates to the data</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelDynCov"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">clv.data.dyn.cov</span> <span class="op">&lt;-</span></span>
<span class="r-in">  <span class="fu"><a href="SetDynamicCovariates.html">SetDynamicCovariates</a></span><span class="op">(</span>clv.data <span class="op">=</span> <span class="va">clv.data.apparel</span>,</span>
<span class="r-in">                       data.cov.life <span class="op">=</span> <span class="va">apparelDynCov</span>,</span>
<span class="r-in">                       data.cov.trans <span class="op">=</span> <span class="va">apparelDynCov</span>,</span>
<span class="r-in">                       names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Marketing"</span>, <span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span>
<span class="r-in">                       names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Marketing"</span>, <span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span>
<span class="r-in">                       name.date <span class="op">=</span> <span class="st">"Cov.Date"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Fit PNBD with dynamic covariates</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.dyn.cov</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The same fitting options as for the</span></span>
<span class="r-in"><span class="co">#  static covariate are available</span></span>
<span class="r-in"><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.dyn.cov</span>, reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>trans<span class="op">=</span><span class="fl">10</span>, life<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Bachmann, Niels Kuebler, Markus Meierer, Jeffrey Naef, Elliot Oblander, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

