<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pareto/NBD models — pnbd • CLVTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Pareto/NBD models — pnbd"><meta property="og:description" content="Fits Pareto/NBD models on transactional data with and without covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-2');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLVTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.12.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/CLVTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bachmannpatrick/CLVTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pareto/NBD models</h1>
    <small class="dont-index">Source: <a href="https://github.com/bachmannpatrick/CLVTools/blob/master/R/f_interface_pnbd.R" class="external-link"><code>R/f_interface_pnbd.R</code></a></small>
    <div class="hidden name"><code>pnbd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits Pareto/NBD models on transactional data with and without covariates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'clv.data'</span></span>
<span><span class="fu">pnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'clv.data.static.covariates'</span></span>
<span><span class="fu">pnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'clv.data.dynamic.covariates'</span></span>
<span><span class="fu">pnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-clv-data">clv.data<a class="anchor" aria-label="anchor" href="#arg-clv-data"></a></dt>
<dd><p>The data object on which the model is fitted.</p></dd>


<dt id="arg-start-params-model">start.params.model<a class="anchor" aria-label="anchor" href="#arg-start-params-model"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for the model without covariates.</p></dd>


<dt id="arg-use-cor">use.cor<a class="anchor" aria-label="anchor" href="#arg-use-cor"></a></dt>
<dd><p>Whether the correlation between the transaction and lifetime process should be estimated.</p></dd>


<dt id="arg-start-param-cor">start.param.cor<a class="anchor" aria-label="anchor" href="#arg-start-param-cor"></a></dt>
<dd><p>Start parameter for the optimization of the correlation.</p></dd>


<dt id="arg-optimx-args">optimx.args<a class="anchor" aria-label="anchor" href="#arg-optimx-args"></a></dt>
<dd><p>Additional arguments to control the optimization which are forwarded to <code><a href="https://rdrr.io/pkg/optimx/man/optimx.html" class="external-link">optimx::optimx</a></code>.
If multiple optimization methods are specified, only the result of the last method is further processed.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Show details about the running of the function.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ignored</p></dd>


<dt id="arg-names-cov-life">names.cov.life<a class="anchor" aria-label="anchor" href="#arg-names-cov-life"></a></dt>
<dd><p>Which of the set Lifetime covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>


<dt id="arg-names-cov-trans">names.cov.trans<a class="anchor" aria-label="anchor" href="#arg-names-cov-trans"></a></dt>
<dd><p>Which of the set Transaction covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>


<dt id="arg-start-params-life">start.params.life<a class="anchor" aria-label="anchor" href="#arg-start-params-life"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for all lifetime covariates.</p></dd>


<dt id="arg-start-params-trans">start.params.trans<a class="anchor" aria-label="anchor" href="#arg-start-params-trans"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for all transaction covariates.</p></dd>


<dt id="arg-names-cov-constr">names.cov.constr<a class="anchor" aria-label="anchor" href="#arg-names-cov-constr"></a></dt>
<dd><p>Which covariates should be forced to use the same parameters for the lifetime and transaction process. The covariates need to be present as both, lifetime and transaction covariates.</p></dd>


<dt id="arg-start-params-constr">start.params.constr<a class="anchor" aria-label="anchor" href="#arg-start-params-constr"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for the constraint covariates.</p></dd>


<dt id="arg-reg-lambdas">reg.lambdas<a class="anchor" aria-label="anchor" href="#arg-reg-lambdas"></a></dt>
<dd><p>Named lambda parameters used for the L2 regularization of the lifetime and the transaction covariate parameters. Lambdas have to be &gt;= 0.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Depending on the data object on which the model was fit, <code>pnbd</code> returns either an object of
class <a href="clv.pnbd-class.html">clv.pnbd</a>, <a href="clv.pnbd.static.cov-class.html">clv.pnbd.static.cov</a>, or <a href="clv.pnbd.dynamic.cov-class.html">clv.pnbd.dynamic.cov</a>.</p>
<p>The function <code><a href="summary.clv.fitted.html">summary</a></code> can be used to obtain and print a summary of the results.
The generic accessor functions <code>coefficients</code>, <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>, and <code>nobs</code> are available.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Model parameters for the Pareto/NBD model are <code>r, alpha, s, and beta</code>. <br><code>s</code>: shape parameter of the Gamma distribution for the lifetime process.
The smaller s, the stronger the heterogeneity of customer lifetimes. <br><code>beta</code>: rate parameter for the Gamma distribution for the lifetime process. <br><code>r</code>: shape parameter of the Gamma distribution of the purchase process.
The smaller r, the stronger the heterogeneity of the purchase process.<br><code>alpha</code>: rate parameter of the Gamma distribution of the purchase process.</p>
<p>Based on these parameters, the average purchase rate while customers are active
is r/alpha and the average dropout rate is s/beta.</p>
<p>Ideally, the starting parameters for r and s represent your best guess
concerning the heterogeneity of customers in their buy and die rate.
If covariates are included into the model additionally parameters for the
covariates affecting the attrition and the purchase process are part of the model.</p>
<p>If no start parameters are given, r=0.5, alpha=15, s=0.5, beta=10 is used for all model parameters and 0.1 for covariate parameters.
The model start parameters are required to be &gt; 0.</p>
<div class="section">
<h3 id="the-pareto-nbd-model">The Pareto/NBD model<a class="anchor" aria-label="anchor" href="#the-pareto-nbd-model"></a></h3>
<p>The Pareto/NBD is the first model addressing the issue of modeling customer purchases and
attrition simultaneously for non-contractual settings. The model uses a Pareto distribution,
a combination of an Exponential and a Gamma distribution, to explicitly model customers'
(unobserved) attrition behavior in addition to customers' purchase process.<br>
In general, the Pareto/NBD model consist of two parts. A first process models the purchase
behavior of customers as long as the customers are active. A second process models customers'
attrition. Customers live (and buy) for a certain unknown time until they become inactive
and "die". Customer attrition is unobserved. Inactive customers may not be reactivated.
For technical details we refer to the original paper by Schmittlein, Morrison and Colombo
(1987) and the detailed technical note of Fader and Hardie (2005).</p>
</div>

<div class="section">
<h3 id="pareto-nbd-model-with-static-covariates">Pareto/NBD model with static covariates<a class="anchor" aria-label="anchor" href="#pareto-nbd-model-with-static-covariates"></a></h3>
<p>The standard Pareto/NBD model captures heterogeneity was solely using Gamma distributions.
However, often exogenous knowledge, such as for example customer demographics, is available.
The supplementary knowledge may explain part of the heterogeneity among the customers and
therefore increase the predictive accuracy of the model. In addition, we can rely on these
parameter estimates for inference, i.e. identify and quantify effects of contextual factors
on the two underlying purchase and attrition processes. For technical details we refer to
the technical note by Fader and Hardie (2007).</p>
</div>

<div class="section">
<h3 id="pareto-nbd-model-with-dynamic-covariates">Pareto/NBD model with dynamic covariates<a class="anchor" aria-label="anchor" href="#pareto-nbd-model-with-dynamic-covariates"></a></h3>
<p>In many real-world applications customer purchase and attrition behavior may be
influenced by covariates that vary over time. In consequence, the timing of a purchase
and the corresponding value of at covariate a that time becomes relevant. Time-varying
covariates can affect customer on aggregated level as well as on an individual level:
In the first case, all customers are affected simultaneously, in the latter case a
covariate is only relevant for a particular customer. For technical details we refer to
the paper by Bachmann, Meierer and Näf (2020).</p>
</div>

    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The Pareto/NBD model with dynamic covariates can currently not be fit with data that has a temporal resolution
of less than one day (data that was built with time unit <code>hours</code>).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Schmittlein DC, Morrison DG, Colombo R (1987). “Counting Your Customers:
Who-Are They and What Will They Do Next?” Management Science, 33(1), 1-24.</p>
<p>Bachmann P, Meierer M, Naef, J (2021). “The Role of Time-Varying Contextual Factors
in Latent Attrition Models for Customer Base Analysis” Marketing Science 40(4). 783-809.</p>
<p>Fader PS, Hardie BGS (2005). “A Note on Deriving the Pareto/NBD Model and
Related Expressions.”
URL <a href="http://www.brucehardie.com/notes/009/pareto_nbd_derivations_2005-11-05.pdf" class="external-link">http://www.brucehardie.com/notes/009/pareto_nbd_derivations_2005-11-05.pdf</a>.</p>
<p>Fader PS, Hardie BGS (2007). “Incorporating time-invariant covariates into the
Pareto/NBD and BG/NBD models.”
URL <a href="http://www.brucehardie.com/notes/019/time_invariant_covariates.pdf" class="external-link">http://www.brucehardie.com/notes/019/time_invariant_covariates.pdf</a>.</p>
<p>Fader PS, Hardie BGS (2020). “Deriving an Expression for P(X(t)=x) Under
the Pareto/NBD Model.”
URL <a href="https://www.brucehardie.com/notes/012/pareto_NBD_pmf_derivation_rev.pdf" class="external-link">https://www.brucehardie.com/notes/012/pareto_NBD_pmf_derivation_rev.pdf</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="clvdata.html">clvdata</a></code> to create a clv data object, <code><a href="SetStaticCovariates.html">SetStaticCovariates</a></code>
to add static covariates to an existing clv data object.</p>
<p><a href="gg.html">gg</a> to fit customer's average spending per transaction with the <code>Gamma-Gamma</code> model</p>
<p><code><a href="predict.clv.fitted.transactions.html">predict</a></code> to predict expected transactions, probability of being alive, and customer lifetime value for every customer</p>
<p><code><a href="plot.clv.fitted.transactions.html">plot</a></code> to plot the unconditional expectation as predicted by the fitted model</p>
<p><code><a href="pmf.html">pmf</a></code> for the probability to make exactly x transactions in the estimation period, given by the probability mass function (PMF).</p>
<p><code><a href="newcustomer.html">newcustomer</a></code> to predict the expected number of transactions for an average new customer.</p>
<p>The generic functions <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="summary.clv.fitted.html">summary</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>.</p>
<p><code><a href="SetDynamicCovariates.html">SetDynamicCovariates</a></code> to add dynamic covariates on which the <code>pnbd</code> model can be fit.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelTrans"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.apparel</span> <span class="op">&lt;-</span> <span class="fu"><a href="clvdata.html">clvdata</a></span><span class="op">(</span><span class="va">apparelTrans</span>, date.format <span class="op">=</span> <span class="st">"ymd"</span>,</span></span>
<span class="r-in"><span>                            time.unit <span class="op">=</span> <span class="st">"w"</span>, estimation.split <span class="op">=</span> <span class="fl">52</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit standard pnbd model</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       r    alpha        s     beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.3080  46.3352   0.4794  70.2292  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Give initial guesses for the model parameters</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>     start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">15</span>, s<span class="op">=</span><span class="fl">0.5</span>, beta<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, start.params.model = c(r = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alpha = 15, s = 0.5, beta = 10))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       r    alpha        s     beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.3080  46.3352   0.4794  70.2292  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pass additional parameters to the optimizer (optimx)</span></span></span>
<span class="r-in"><span><span class="co">#    Use Nelder-Mead as optimization method and print</span></span></span>
<span class="r-in"><span><span class="co">#    detailed information about the optimization process</span></span></span>
<span class="r-in"><span><span class="va">apparel.pnbd</span> <span class="op">&lt;-</span> <span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                     optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span></span>
<span class="r-in"><span>                                        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn is  fn1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Looking for method =  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Methods to be used:[1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optcfg:$fname</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fn1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $npar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$follow.on</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$save.failures</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$trace</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$all.methods</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$starttests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$maximize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$dowarn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkttol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt2tol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$badval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.988466e+307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$scaletol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ufn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (par) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn(par, ...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x141ed5458&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x151ed0e00&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Nelder-Mead direct search function minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function value for initial parameters = 3577.490724</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Scaled convergence tolerance is 5.33088e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stepsize computed as 0.270805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BUILD              5 3618.102926 3557.499818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION          7 3588.766454 3515.206187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION       9 3577.490724 3515.206187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      11 3560.629019 3515.206187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      13 3557.499818 3515.206187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         15 3538.949426 3502.124657</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         17 3522.301702 3491.315153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      19 3520.130144 3491.315153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      21 3515.206187 3491.315153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         23 3502.124657 3487.029141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      25 3494.722953 3487.029141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        27 3493.410647 3485.989378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      29 3491.315153 3485.989378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      31 3487.841273 3485.989378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      33 3487.231847 3485.989378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      35 3487.029141 3485.989378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         37 3486.635771 3484.509002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      39 3486.256159 3484.509002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      41 3486.135308 3484.509002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      43 3485.989378 3484.509002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      45 3485.602665 3484.509002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        47 3485.131743 3484.022296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      49 3485.094658 3484.022296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        51 3484.734465 3483.944565</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         53 3484.509002 3483.051738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      55 3484.390375 3483.051738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         57 3484.022296 3482.672127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      59 3483.944565 3482.672127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      61 3483.885871 3482.672127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      63 3483.183497 3482.672127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      65 3483.051738 3482.605147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      67 3482.869919 3482.605147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      69 3482.678491 3482.605147</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      71 3482.677209 3482.586838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      73 3482.672127 3482.586838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      75 3482.626645 3482.586838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      77 3482.606469 3482.584373</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        79 3482.605147 3482.570883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      81 3482.591298 3482.570883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      83 3482.586838 3482.570883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        85 3482.584373 3482.562448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      87 3482.578339 3482.562448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      89 3482.574087 3482.562448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         91 3482.570883 3482.546872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      93 3482.569656 3482.546872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      95 3482.564846 3482.546872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        97 3482.562448 3482.545725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      99 3482.559624 3482.545725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        101 3482.552132 3482.529225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     103 3482.548141 3482.529225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     105 3482.546872 3482.529225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        107 3482.545725 3482.524888</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       109 3482.539489 3482.523911</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        111 3482.532682 3482.508336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     113 3482.529225 3482.508336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     115 3482.524888 3482.508336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     117 3482.523911 3482.508336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     119 3482.518928 3482.508336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     121 3482.518699 3482.508336</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        123 3482.516119 3482.501974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        125 3482.511347 3482.491345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     127 3482.509855 3482.491345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        129 3482.508336 3482.479883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     131 3482.501974 3482.479883</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        133 3482.491895 3482.451710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     135 3482.491345 3482.451710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     137 3482.485097 3482.451710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        139 3482.479883 3482.426861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     141 3482.467825 3482.426861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        143 3482.464402 3482.392452</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        145 3482.451710 3482.362389</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        147 3482.434120 3482.326554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     149 3482.426861 3482.326554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        151 3482.392452 3482.234085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     153 3482.362389 3482.234085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     155 3482.333002 3482.234085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     157 3482.326554 3482.234085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     159 3482.270427 3482.228485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        161 3482.249626 3482.187145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     163 3482.243048 3482.187145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        165 3482.234085 3482.143757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     167 3482.228485 3482.143757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        169 3482.187150 3482.076034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     171 3482.187145 3482.076034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        173 3482.168268 3482.051621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     175 3482.143757 3482.051621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       177 3482.100647 3482.024184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       179 3482.076034 3482.022426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     181 3482.051696 3482.022426</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       183 3482.051621 3481.999804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     185 3482.030557 3481.999804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     187 3482.024184 3481.999804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     189 3482.022426 3481.999429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     191 3482.014260 3481.999429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     193 3482.005517 3481.998573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     195 3482.005327 3481.998573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       197 3481.999804 3481.992755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     199 3481.999429 3481.992755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     201 3481.999171 3481.992755</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       203 3481.998573 3481.992659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     205 3481.996090 3481.992659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        207 3481.995202 3481.989353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        209 3481.994861 3481.987456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     211 3481.992755 3481.987456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       213 3481.992659 3481.986721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        215 3481.989353 3481.980449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     217 3481.987760 3481.980449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     219 3481.987456 3481.980449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     221 3481.986721 3481.980449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        223 3481.984187 3481.978655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     225 3481.983425 3481.978655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     227 3481.981552 3481.978655</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       229 3481.980449 3481.978351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     231 3481.979349 3481.978351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     233 3481.978943 3481.978351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     235 3481.978704 3481.978351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       237 3481.978655 3481.978253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     239 3481.978629 3481.978253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     241 3481.978532 3481.978253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     243 3481.978351 3481.978253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     245 3481.978345 3481.978253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     247 3481.978321 3481.978252</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     249 3481.978295 3481.978236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exiting from Nelder Mead minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     251 function evaluations used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post processing for method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Successful convergence! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute Hessian approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute gradient approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Save results from method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      log.r  log.alpha      log.s   log.beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2678451  3.8353761 -0.7332306  4.2554487 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3481.978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convcode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      251 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nitns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xtimes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> user.self </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.044 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assemble the answers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimated coefs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          r      alpha          s       beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.3071447 46.3108420  0.4803547 70.4884348 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary of the fitted model.</span></span></span>
<span class="r-in"><span><span class="co"># Note that the significance indicators are set to NA on purpose because all</span></span></span>
<span class="r-in"><span><span class="co"># model parameters are by definition strictly positive. A hypothesis test</span></span></span>
<span class="r-in"><span><span class="co"># relative to a null of 0 therefore does not make sense.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD Standard  Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, optimx.args = list(method = "Nelder-Mead", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = list(trace = 6)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting period:                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation start  2005-01-02   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation end    2006-01-01   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation length 52.0000 Weeks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error z-val Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r       1.3071     0.2123    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha  46.3108     7.5368    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s       0.4804     1.0819    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta   70.4884   203.3985    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization info:                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LL     -3481.9782 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC    6971.9565  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC    6989.5442  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 1  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 2  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fevals 251.0000   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method Nelder-Mead</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict CLV etc for holdout period</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2010-12-20 (259.14 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2010-12-20      259.1429        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2010-12-20      259.1429        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2010-12-20      259.1429        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2010-12-20      259.1429        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending    PAlive      CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;     &lt;num&gt;    &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                 524.10 0.9163171 4.080260 0.21731960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                  63.31 0.8411806 3.745685 0.19949974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                 333.35 0.6578365 1.659621 0.08839341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                   0.00 0.8946531 3.983793 0.21218163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                   0.00 0.6578365 1.659621 0.08839341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                 113.80 0.9400910 4.186123 0.22295799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                 253.61 0.6578365 1.659621 0.08839341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                   0.00 0.6578365 1.659621 0.08839341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                   0.00 0.9655447 4.299465 0.22899475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                  13.99 0.9384998 5.990383 0.31905509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.mean.spending predicted.period.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        &lt;num&gt;                     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                63.77959                 260.23732     13.860556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                38.10316                 142.72242      7.601570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                37.12434                  61.61231      3.281547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                33.08404                 131.79995      7.019826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                37.12434                  61.61231      3.281547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                28.29614                 118.45113      6.308851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                37.12434                  61.61231      3.281547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                37.12434                  61.61231      3.281547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                34.87739                 149.95411      7.986738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                16.11315                  96.52392      5.140981</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict CLV etc for the next 15 periods</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.pnbd</span>, prediction.end <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2006-04-16 (15 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;int&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2006-04-16            15        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending    PAlive       CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;     &lt;num&gt;     &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                  217.5 0.9163171 0.3136059 0.21731960</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                    0.0 0.8411806 0.2878907 0.19949974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                    0.0 0.6578365 0.1275573 0.08839341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                    0.0 0.8946531 0.3061915 0.21218163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                    0.0 0.6578365 0.1275573 0.08839341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                    0.0 0.9400910 0.3217425 0.22295799</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                    0.0 0.6578365 0.1275573 0.08839341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                    0.0 0.6578365 0.1275573 0.08839341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                    0.0 0.9655447 0.3304539 0.22899475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                    0.0 0.9384998 0.4604166 0.31905509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.mean.spending predicted.period.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        &lt;num&gt;                     &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                63.77959                 20.001658     13.860556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                38.10316                 10.969545      7.601570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                37.12434                  4.735479      3.281547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                33.08404                 10.130052      7.019826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                37.12434                  4.735479      3.281547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                28.29614                  9.104071      6.308851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                37.12434                  4.735479      3.281547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                37.12434                  4.735479      3.281547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                34.87739                 11.525368      7.986738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                16.11315                  7.418761      5.140981</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Estimate correlation as well</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>, use.cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, use.cor = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               r            alpha                s             beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.308e+00        4.635e+01        4.812e-01        7.070e+01  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cor(life,trans)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.337e-04  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     TRUE </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># To estimate the pnbd model with static covariates,</span></span></span>
<span class="r-in"><span><span class="co">#   add static covariates to the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelStaticCov"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.static.cov</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="SetStaticCovariates.html">SetStaticCovariates</a></span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                     data.cov.life <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span></span>
<span class="r-in"><span>                     names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     data.cov.trans <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span></span>
<span class="r-in"><span>                     names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit pnbd with static covariates</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       1.64665      103.87040        0.37840      312.71650       -0.01945  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2.76685        0.46979        0.73713  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Give initial guesses for both covariate parameters</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.75</span>, Channel<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   start.params.life  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span>, Channel<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, start.params.life = c(Gender = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Channel = 0.5), start.params.trans = c(Gender = 0.75, Channel = 0.7))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.644181     103.934303       0.374328     327.398551      -0.007976  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2.821026       0.470843       0.738306  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use regularization</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="fl">5</span>, life<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, reg.lambdas = c(trans = 5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     life = 5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1.317e+00      4.693e+01      4.773e-01      6.959e+01     -7.734e-04  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -5.999e-05      6.173e-03      6.701e-03  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  TRUE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Force the same coefficient to be used for both covariates</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.constr <span class="op">=</span> <span class="st">"Gender"</span>,</span></span>
<span class="r-in"><span>                   start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, names.cov.constr = "Gender", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     start.params.constr = c(Gender = 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta   life.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.6170       104.1740         0.3555       567.3024         3.1126  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trans.Channel  constr.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.7327         0.4921  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model only with the Channel covariate for life but</span></span></span>
<span class="r-in"><span><span class="co"># keep all trans covariates as is</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, names.cov.life = c("Channel"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta   life.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.6462       103.8871         0.3785       311.7797         2.7509  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.4712         0.7364  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Add dynamic covariates data to the data object</span></span></span>
<span class="r-in"><span><span class="co">#   add dynamic covariates to the data</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelDynCov"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.dyn.cov</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="SetDynamicCovariates.html">SetDynamicCovariates</a></span><span class="op">(</span>clv.data <span class="op">=</span> <span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                       data.cov.life <span class="op">=</span> <span class="va">apparelDynCov</span>,</span></span>
<span class="r-in"><span>                       data.cov.trans <span class="op">=</span> <span class="va">apparelDynCov</span>,</span></span>
<span class="r-in"><span>                       names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High.Season"</span>, <span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"High.Season"</span>, <span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       name.date <span class="op">=</span> <span class="st">"Cov.Date"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit PNBD with dynamic covariates</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.dyn.cov</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same fitting options as for the</span></span></span>
<span class="r-in"><span><span class="co">#  static covariate are available</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.dyn.cov</span>, reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>trans<span class="op">=</span><span class="fl">10</span>, life<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Bachmann, Niels Kuebler, Markus Meierer, Jeffrey Naef, E. Shin Oblander, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

