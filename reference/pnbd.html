<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Pareto/NBD models — pnbd • CLVTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Pareto/NBD models — pnbd"><meta property="og:description" content="Fits Pareto/NBD models on transactional data with and without covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-2');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLVTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.11.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/CLVTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/internal_docu/internal_docu.html">Internal Package Documentation</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bachmannpatrick/CLVTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pareto/NBD models</h1>
    <small class="dont-index">Source: <a href="https://github.com/bachmannpatrick/CLVTools/blob/master/R/f_interface_pnbd.R" class="external-link"><code>R/f_interface_pnbd.R</code></a></small>
    <div class="hidden name"><code>pnbd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits Pareto/NBD models on transactional data with and without covariates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'clv.data'</span></span>
<span><span class="fu">pnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'clv.data.static.covariates'</span></span>
<span><span class="fu">pnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'clv.data.dynamic.covariates'</span></span>
<span><span class="fu">pnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  use.cor <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start.param.cor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-clv-data">clv.data<a class="anchor" aria-label="anchor" href="#arg-clv-data"></a></dt>
<dd><p>The data object on which the model is fitted.</p></dd>


<dt id="arg-start-params-model">start.params.model<a class="anchor" aria-label="anchor" href="#arg-start-params-model"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for the model without covariates.</p></dd>


<dt id="arg-use-cor">use.cor<a class="anchor" aria-label="anchor" href="#arg-use-cor"></a></dt>
<dd><p>Whether the correlation between the transaction and lifetime process should be estimated.</p></dd>


<dt id="arg-start-param-cor">start.param.cor<a class="anchor" aria-label="anchor" href="#arg-start-param-cor"></a></dt>
<dd><p>Start parameter for the optimization of the correlation.</p></dd>


<dt id="arg-optimx-args">optimx.args<a class="anchor" aria-label="anchor" href="#arg-optimx-args"></a></dt>
<dd><p>Additional arguments to control the optimization which are forwarded to <code><a href="https://rdrr.io/pkg/optimx/man/optimx.html" class="external-link">optimx::optimx</a></code>.
If multiple optimization methods are specified, only the result of the last method is further processed.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Show details about the running of the function.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ignored</p></dd>


<dt id="arg-names-cov-life">names.cov.life<a class="anchor" aria-label="anchor" href="#arg-names-cov-life"></a></dt>
<dd><p>Which of the set Lifetime covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>


<dt id="arg-names-cov-trans">names.cov.trans<a class="anchor" aria-label="anchor" href="#arg-names-cov-trans"></a></dt>
<dd><p>Which of the set Transaction covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>


<dt id="arg-start-params-life">start.params.life<a class="anchor" aria-label="anchor" href="#arg-start-params-life"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for all lifetime covariates.</p></dd>


<dt id="arg-start-params-trans">start.params.trans<a class="anchor" aria-label="anchor" href="#arg-start-params-trans"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for all transaction covariates.</p></dd>


<dt id="arg-names-cov-constr">names.cov.constr<a class="anchor" aria-label="anchor" href="#arg-names-cov-constr"></a></dt>
<dd><p>Which covariates should be forced to use the same parameters for the lifetime and transaction process. The covariates need to be present as both, lifetime and transaction covariates.</p></dd>


<dt id="arg-start-params-constr">start.params.constr<a class="anchor" aria-label="anchor" href="#arg-start-params-constr"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for the constraint covariates.</p></dd>


<dt id="arg-reg-lambdas">reg.lambdas<a class="anchor" aria-label="anchor" href="#arg-reg-lambdas"></a></dt>
<dd><p>Named lambda parameters used for the L2 regularization of the lifetime and the transaction covariate parameters. Lambdas have to be &gt;= 0.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Depending on the data object on which the model was fit, <code>pnbd</code> returns either an object of
class <a href="clv.pnbd-class.html">clv.pnbd</a>, <a href="clv.pnbd.static.cov-class.html">clv.pnbd.static.cov</a>, or <a href="clv.pnbd.dynamic.cov-class.html">clv.pnbd.dynamic.cov</a>.</p>
<p>The function <code><a href="summary.clv.fitted.html">summary</a></code> can be used to obtain and print a summary of the results.
The generic accessor functions <code>coefficients</code>, <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>, and <code>nobs</code> are available.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Model parameters for the Pareto/NBD model are <code>alpha, r, beta, and s</code>. <br><code>s</code>: shape parameter of the Gamma distribution for the lifetime process.
The smaller s, the stronger the heterogeneity of customer lifetimes. <br><code>beta</code>: rate parameter for the Gamma distribution for the lifetime process. <br><code>r</code>: shape parameter of the Gamma distribution of the purchase process.
The smaller r, the stronger the heterogeneity of the purchase process.<br><code>alpha</code>: rate parameter of the Gamma distribution of the purchase process.</p>
<p>Based on these parameters, the average purchase rate while customers are active
is r/alpha and the average dropout rate is s/beta.</p>
<p>Ideally, the starting parameters for r and s represent your best guess
concerning the heterogeneity of customers in their buy and die rate.
If covariates are included into the model additionally parameters for the
covariates affecting the attrition and the purchase process are part of the model.</p>
<p>If no start parameters are given, r=0.5, alpha=15, s=0.5, beta=10 is used for all model parameters and 0.1 for covariate parameters.
The model start parameters are required to be &gt; 0.</p>
<div class="section">
<h3 id="the-pareto-nbd-model">The Pareto/NBD model<a class="anchor" aria-label="anchor" href="#the-pareto-nbd-model"></a></h3>
<p>The Pareto/NBD is the first model addressing the issue of modeling customer purchases and
attrition simultaneously for non-contractual settings. The model uses a Pareto distribution,
a combination of an Exponential and a Gamma distribution, to explicitly model customers'
(unobserved) attrition behavior in addition to customers' purchase process.<br>
In general, the Pareto/NBD model consist of two parts. A first process models the purchase
behavior of customers as long as the customers are active. A second process models customers'
attrition. Customers live (and buy) for a certain unknown time until they become inactive
and "die". Customer attrition is unobserved. Inactive customers may not be reactivated.
For technical details we refer to the original paper by Schmittlein, Morrison and Colombo
(1987) and the detailed technical note of Fader and Hardie (2005).</p>
</div>

<div class="section">
<h3 id="pareto-nbd-model-with-static-covariates">Pareto/NBD model with static covariates<a class="anchor" aria-label="anchor" href="#pareto-nbd-model-with-static-covariates"></a></h3>
<p>The standard Pareto/NBD model captures heterogeneity was solely using Gamma distributions.
However, often exogenous knowledge, such as for example customer demographics, is available.
The supplementary knowledge may explain part of the heterogeneity among the customers and
therefore increase the predictive accuracy of the model. In addition, we can rely on these
parameter estimates for inference, i.e. identify and quantify effects of contextual factors
on the two underlying purchase and attrition processes. For technical details we refer to
the technical note by Fader and Hardie (2007).</p>
</div>

<div class="section">
<h3 id="pareto-nbd-model-with-dynamic-covariates">Pareto/NBD model with dynamic covariates<a class="anchor" aria-label="anchor" href="#pareto-nbd-model-with-dynamic-covariates"></a></h3>
<p>In many real-world applications customer purchase and attrition behavior may be
influenced by covariates that vary over time. In consequence, the timing of a purchase
and the corresponding value of at covariate a that time becomes relevant. Time-varying
covariates can affect customer on aggregated level as well as on an individual level:
In the first case, all customers are affected simultaneously, in the latter case a
covariate is only relevant for a particular customer. For technical details we refer to
the paper by Bachmann, Meierer and Näf (2020).</p>
</div>

    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The Pareto/NBD model with dynamic covariates can currently not be fit with data that has a temporal resolution
of less than one day (data that was built with time unit <code>hours</code>).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Schmittlein DC, Morrison DG, Colombo R (1987). “Counting Your Customers:
Who-Are They and What Will They Do Next?” Management Science, 33(1), 1-24.</p>
<p>Bachmann P, Meierer M, Naef, J (2021). “The Role of Time-Varying Contextual Factors
in Latent Attrition Models for Customer Base Analysis” Marketing Science 40(4). 783-809.</p>
<p>Fader PS, Hardie BGS (2005). “A Note on Deriving the Pareto/NBD Model and
Related Expressions.”
URL <a href="http://www.brucehardie.com/notes/009/pareto_nbd_derivations_2005-11-05.pdf" class="external-link">http://www.brucehardie.com/notes/009/pareto_nbd_derivations_2005-11-05.pdf</a>.</p>
<p>Fader PS, Hardie BGS (2007). “Incorporating time-invariant covariates into the
Pareto/NBD and BG/NBD models.”
URL <a href="http://www.brucehardie.com/notes/019/time_invariant_covariates.pdf" class="external-link">http://www.brucehardie.com/notes/019/time_invariant_covariates.pdf</a>.</p>
<p>Fader PS, Hardie BGS (2020). “Deriving an Expression for P(X(t)=x) Under
the Pareto/NBD Model.”
URL <a href="https://www.brucehardie.com/notes/012/pareto_NBD_pmf_derivation_rev.pdf" class="external-link">https://www.brucehardie.com/notes/012/pareto_NBD_pmf_derivation_rev.pdf</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="clvdata.html">clvdata</a></code> to create a clv data object, <code><a href="SetStaticCovariates.html">SetStaticCovariates</a></code>
to add static covariates to an existing clv data object.</p>
<p><a href="gg.html">gg</a> to fit customer's average spending per transaction with the <code>Gamma-Gamma</code> model</p>
<p><code><a href="predict.clv.fitted.transactions.html">predict</a></code> to predict expected transactions, probability of being alive, and customer lifetime value for every customer</p>
<p><code><a href="plot.clv.fitted.transactions.html">plot</a></code> to plot the unconditional expectation as predicted by the fitted model</p>
<p><code><a href="pmf.html">pmf</a></code> for the probability to make exactly x transactions in the estimation period, given by the probability mass function (PMF).</p>
<p><code><a href="newcustomer.html">newcustomer</a></code> to predict the expected number of transactions for an average new customer.</p>
<p>The generic functions <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="summary.clv.fitted.html">summary</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>.</p>
<p><code><a href="SetDynamicCovariates.html">SetDynamicCovariates</a></code> to add dynamic covariates on which the <code>pnbd</code> model can be fit.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelTrans"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.apparel</span> <span class="op">&lt;-</span> <span class="fu"><a href="clvdata.html">clvdata</a></span><span class="op">(</span><span class="va">apparelTrans</span>, date.format <span class="op">=</span> <span class="st">"ymd"</span>,</span></span>
<span class="r-in"><span>                            time.unit <span class="op">=</span> <span class="st">"w"</span>, estimation.split <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit standard pnbd model</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       r    alpha        s     beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7858   5.3312   0.3606  11.8221  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Give initial guesses for the model parameters</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>     start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">15</span>, s<span class="op">=</span><span class="fl">0.5</span>, beta<span class="op">=</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, start.params.model = c(r = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alpha = 15, s = 0.5, beta = 10))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       r    alpha        s     beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7858   5.3312   0.3606  11.8221  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pass additional parameters to the optimizer (optimx)</span></span></span>
<span class="r-in"><span><span class="co">#    Use Nelder-Mead as optimization method and print</span></span></span>
<span class="r-in"><span><span class="co">#    detailed information about the optimization process</span></span></span>
<span class="r-in"><span><span class="va">apparel.pnbd</span> <span class="op">&lt;-</span> <span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                     optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span></span>
<span class="r-in"><span>                                        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn is  fn1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Looking for method =  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Methods to be used:[1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optcfg:$fname</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fn1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $npar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$follow.on</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$save.failures</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$trace</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$all.methods</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$starttests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$maximize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$dowarn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkttol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt2tol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$badval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.988466e+307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$scaletol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ufn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (par) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn(par, ...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x12e143cb8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x13a1cd2a8&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Nelder-Mead direct search function minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function value for initial parameters = 3054.783875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Scaled convergence tolerance is 4.55198e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stepsize computed as 0.270805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BUILD              5 3130.171249 3012.666615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION          7 3073.973545 2934.108266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION       9 3054.783875 2934.108266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         11 3046.196662 2890.274544</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        13 3012.666615 2885.087876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        15 2953.224793 2880.665503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      17 2934.108266 2880.665503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      19 2890.274544 2880.665503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      21 2886.242588 2880.665503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      23 2885.087876 2880.665503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      25 2882.431079 2880.665503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      27 2882.373576 2880.286217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      29 2881.398381 2880.286217</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         31 2881.323229 2879.756503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      33 2880.665503 2879.748586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      35 2880.356248 2879.748586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      37 2880.286217 2879.675815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      39 2880.004056 2879.675815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      41 2879.821861 2879.675815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      43 2879.756503 2879.675815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      45 2879.748586 2879.669232</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      47 2879.691775 2879.668339</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      49 2879.686220 2879.652021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      51 2879.675815 2879.652021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      53 2879.669232 2879.652021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      55 2879.668339 2879.652021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      57 2879.658041 2879.652021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      59 2879.653671 2879.650385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        61 2879.653554 2879.648557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        63 2879.653031 2879.645463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      65 2879.652021 2879.645463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      67 2879.650385 2879.645463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         69 2879.648557 2879.639035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      71 2879.647520 2879.639035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      73 2879.646944 2879.639035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         75 2879.645463 2879.631207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      77 2879.643620 2879.631207</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         79 2879.642257 2879.627502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      81 2879.639035 2879.627502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         83 2879.635380 2879.611646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      85 2879.631207 2879.611646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      87 2879.629717 2879.611646</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         89 2879.627502 2879.596842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         91 2879.620950 2879.581402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         93 2879.614418 2879.564653</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         95 2879.611646 2879.541865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         97 2879.596842 2879.512661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         99 2879.581402 2879.484609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     101 2879.564653 2879.484609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     103 2879.541865 2879.484609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     105 2879.512661 2879.484609</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       107 2879.489001 2879.482623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       109 2879.487967 2879.477322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       111 2879.485488 2879.473094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     113 2879.484609 2879.473094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     115 2879.482623 2879.473094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     117 2879.477322 2879.473094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     119 2879.477157 2879.473094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        121 2879.475811 2879.470484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     123 2879.474730 2879.470484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     125 2879.473882 2879.470484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     127 2879.473094 2879.470484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     129 2879.472662 2879.470381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     131 2879.470911 2879.470381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     133 2879.470860 2879.470381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       135 2879.470730 2879.470063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     137 2879.470492 2879.470063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     139 2879.470484 2879.470063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     141 2879.470381 2879.470063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     143 2879.470174 2879.470039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       145 2879.470168 2879.470019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       147 2879.470072 2879.469968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     149 2879.470063 2879.469968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     151 2879.470039 2879.469968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     153 2879.470019 2879.469968</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exiting from Nelder Mead minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     155 function evaluations used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post processing for method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Successful convergence! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute Hessian approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute gradient approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Save results from method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      log.r  log.alpha      log.s   log.beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.2402537  1.6745955 -1.0319390  2.4497084 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2879.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convcode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      155 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nitns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xtimes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> user.self </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.018 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assemble the answers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimated coefs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          r      alpha          s       beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7864283  5.3366358  0.3563154 11.5849676 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary of the fitted model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD Standard  Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, optimx.args = list(method = "Nelder-Mead", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = list(trace = 6)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting period:                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation start  2005-01-03   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation end    2005-10-10   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation length 40.0000 Weeks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Estimate Std. Error z-val Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r       0.7864     0.1323 5.944 2.78e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha   5.3366     0.9025 5.913 3.36e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s       0.3563     0.1830 1.947   0.0516 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta   11.5850    10.6138 1.092   0.2751    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization info:                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LL     -2879.4700 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC    5766.9399  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC    5781.0258  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 1  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 2  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fevals 155.0000   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method Nelder-Mead</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict CLV etc for holdout period</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.pnbd</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2005-10-11 until (incl.) 2006-07-16 (39.86 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2005-10-11  2006-07-16      39.85714        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2005-10-11  2006-07-16      39.85714        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2005-10-11  2006-07-16      39.85714       23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:   1000   2005-10-11  2006-07-16      39.85714       23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:   1001   2005-10-11  2006-07-16      39.85714       11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246:   1219   2005-10-11  2006-07-16      39.85714       14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247:    122   2005-10-11  2006-07-16      39.85714        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248:   1220   2005-10-11  2006-07-16      39.85714        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249:   1221   2005-10-11  2006-07-16      39.85714        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250:   1222   2005-10-11  2006-07-16      39.85714        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.total.spending    PAlive        CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;num&gt;     &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                  0.00 0.3574086  0.2213742 0.06124756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                  0.00 0.4229262  0.9281438 0.25678942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                737.53 0.9156653 13.5482683 3.74839745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:               1069.91 0.9967828 13.1783679 3.64605717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                364.00 0.5102077  3.5307112 0.97684137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246:                413.76 0.9579838  3.6113745 0.99915845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247:                  0.00 0.3574086  0.2213742 0.06124756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248:                  0.00 0.3574086  0.2213742 0.06124756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249:                302.65 0.9435096  4.2999136 1.18965648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250:                  0.00 0.4139543  0.5824260 0.16113973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.mean.spending predicted.total.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        &lt;num&gt;                    &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                39.95483                 8.844967      2.447136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                55.23031                51.261670     14.182559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                43.57390               590.350880    163.332293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                41.60921               548.341440    151.709548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                45.58153               160.935208     44.525921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246:                33.58728               121.296238     33.559013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247:                39.95483                 8.844967      2.447136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248:                39.95483                 8.844967      2.447136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249:                34.28958               147.442230     40.792821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250:                47.35500                27.580786      7.630772</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict CLV etc for the next 15 periods</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.pnbd</span>, prediction.end <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2005-10-11 until (incl.) 2006-01-23 (15 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;int&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2005-10-11  2006-01-23            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2005-10-11  2006-01-23            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2005-10-11  2006-01-23            15       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:   1000   2005-10-11  2006-01-23            15       10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:   1001   2005-10-11  2006-01-23            15        6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246:   1219   2005-10-11  2006-01-23            15       11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247:    122   2005-10-11  2006-01-23            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248:   1220   2005-10-11  2006-01-23            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249:   1221   2005-10-11  2006-01-23            15        7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250:   1222   2005-10-11  2006-01-23            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.total.spending    PAlive        CET       DERT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;num&gt;     &lt;num&gt;      &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                  0.00 0.3574086 0.08872108 0.06124756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                  0.00 0.4229262 0.37197621 0.25678942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                224.71 0.9156653 5.42979800 3.74839745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                343.11 0.9967828 5.28155143 3.64605717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                206.65 0.5102077 1.41501839 0.97684137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246:                325.05 0.9579838 1.44734614 0.99915845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247:                  0.00 0.3574086 0.08872108 0.06124756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248:                  0.00 0.3574086 0.08872108 0.06124756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249:                158.46 0.9435096 1.72329495 1.18965648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250:                  0.00 0.4139543 0.23342140 0.16113973</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      predicted.mean.spending predicted.total.spending predicted.CLV</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        &lt;num&gt;                    &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                39.95483                 3.544835      2.447136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                55.23031                20.544361     14.182559</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                43.57390               236.597472    163.332293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                41.60921               219.761167    151.709548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                45.58153                64.498698     44.525921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 246:                33.58728                48.612417     33.559013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 247:                39.95483                 3.544835      2.447136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 248:                39.95483                 3.544835      2.447136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 249:                34.28958                59.091059     40.792821</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 250:                47.35500                11.053671      7.630772</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Estimate correlation as well</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>, use.cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.apparel, use.cor = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               r            alpha                s             beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.78443          5.31381          0.35410         11.52172  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cor(life,trans)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.00495  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     TRUE </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># To estimate the pnbd model with static covariates,</span></span></span>
<span class="r-in"><span><span class="co">#   add static covariates to the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelStaticCov"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.static.cov</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="SetStaticCovariates.html">SetStaticCovariates</a></span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                     data.cov.life <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span></span>
<span class="r-in"><span>                     names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     data.cov.trans <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span></span>
<span class="r-in"><span>                     names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit pnbd with static covariates</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.4201        35.6425         0.2729         8.5634         1.5215  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -1.7010         1.4228         0.4024  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Give initial guesses for both covariate parameters</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.75</span>, Channel<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   start.params.life  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span>, Channel<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, start.params.life = c(Gender = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Channel = 0.5), start.params.trans = c(Gender = 0.75, Channel = 0.7))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.4175        35.6357         0.2730         8.6759         1.5335  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -1.7026         1.4240         0.4028  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use regularization</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="fl">5</span>, life<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, reg.lambdas = c(trans = 5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     life = 5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.7921514      5.4472757      0.3603584     11.7402269     -0.0004837  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -0.0023797      0.0106719      0.0087680  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  TRUE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Force the same coefficient to be used for both covariates</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.constr <span class="op">=</span> <span class="st">"Gender"</span>,</span></span>
<span class="r-in"><span>                   start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, names.cov.constr = "Gender", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     start.params.constr = c(Gender = 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta   life.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.4230        35.4434         0.2741         7.8762        -1.6881  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trans.Channel  constr.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.4017         1.4156  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model only with the Channel covariate for life but</span></span></span>
<span class="r-in"><span><span class="co"># keep all trans covariates as is</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pareto/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pnbd(clv.data = clv.data.static.cov, names.cov.life = c("Channel"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              s           beta   life.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.4924        32.1618         0.2496         1.7968        -1.6954  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.2723         0.3933  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Used Options:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correlation:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Add dynamic covariates data to the data object</span></span></span>
<span class="r-in"><span><span class="co">#   add dynamic covariates to the data</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelDynCov"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.dyn.cov</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="SetDynamicCovariates.html">SetDynamicCovariates</a></span><span class="op">(</span>clv.data <span class="op">=</span> <span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                       data.cov.life <span class="op">=</span> <span class="va">apparelDynCov</span>,</span></span>
<span class="r-in"><span>                       data.cov.trans <span class="op">=</span> <span class="va">apparelDynCov</span>,</span></span>
<span class="r-in"><span>                       names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Marketing"</span>, <span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Marketing"</span>, <span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                       name.date <span class="op">=</span> <span class="st">"Cov.Date"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit PNBD with dynamic covariates</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.dyn.cov</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same fitting options as for the</span></span></span>
<span class="r-in"><span><span class="co">#  static covariate are available</span></span></span>
<span class="r-in"><span><span class="fu">pnbd</span><span class="op">(</span><span class="va">clv.data.dyn.cov</span>, reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>trans<span class="op">=</span><span class="fl">10</span>, life<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Bachmann, Niels Kuebler, Markus Meierer, Jeffrey Naef, E. Shin Oblander, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

