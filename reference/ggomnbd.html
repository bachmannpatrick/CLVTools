<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Gamma-Gompertz/NBD model — ggomnbd • CLVTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Gamma-Gompertz/NBD model — ggomnbd"><meta property="og:description" content="Fits Gamma-Gompertz/NBD models on transactional data with static and without covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-2');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLVTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.12.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/CLVTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bachmannpatrick/CLVTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Gamma-Gompertz/NBD model</h1>
    <small class="dont-index">Source: <a href="https://github.com/bachmannpatrick/CLVTools/blob/master/R/f_interface_ggomnbd.R" class="external-link"><code>R/f_interface_ggomnbd.R</code></a></small>
    <div class="hidden name"><code>ggomnbd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits Gamma-Gompertz/NBD models on transactional data with static and without covariates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'clv.data'</span></span>
<span><span class="fu">ggomnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'clv.data.static.covariates'</span></span>
<span><span class="fu">ggomnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-clv-data">clv.data<a class="anchor" aria-label="anchor" href="#arg-clv-data"></a></dt>
<dd><p>The data object on which the model is fitted.</p></dd>


<dt id="arg-start-params-model">start.params.model<a class="anchor" aria-label="anchor" href="#arg-start-params-model"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for the model without covariates.</p></dd>


<dt id="arg-optimx-args">optimx.args<a class="anchor" aria-label="anchor" href="#arg-optimx-args"></a></dt>
<dd><p>Additional arguments to control the optimization which are forwarded to <code><a href="https://rdrr.io/pkg/optimx/man/optimx.html" class="external-link">optimx::optimx</a></code>.
If multiple optimization methods are specified, only the result of the last method is further processed.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Show details about the running of the function.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ignored</p></dd>


<dt id="arg-names-cov-life">names.cov.life<a class="anchor" aria-label="anchor" href="#arg-names-cov-life"></a></dt>
<dd><p>Which of the set Lifetime covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>


<dt id="arg-names-cov-trans">names.cov.trans<a class="anchor" aria-label="anchor" href="#arg-names-cov-trans"></a></dt>
<dd><p>Which of the set Transaction covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>


<dt id="arg-start-params-life">start.params.life<a class="anchor" aria-label="anchor" href="#arg-start-params-life"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for all lifetime covariates.</p></dd>


<dt id="arg-start-params-trans">start.params.trans<a class="anchor" aria-label="anchor" href="#arg-start-params-trans"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for all transaction covariates.</p></dd>


<dt id="arg-names-cov-constr">names.cov.constr<a class="anchor" aria-label="anchor" href="#arg-names-cov-constr"></a></dt>
<dd><p>Which covariates should be forced to use the same parameters for the lifetime and transaction process. The covariates need to be present as both, lifetime and transaction covariates.</p></dd>


<dt id="arg-start-params-constr">start.params.constr<a class="anchor" aria-label="anchor" href="#arg-start-params-constr"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for the constraint covariates.</p></dd>


<dt id="arg-reg-lambdas">reg.lambdas<a class="anchor" aria-label="anchor" href="#arg-reg-lambdas"></a></dt>
<dd><p>Named lambda parameters used for the L2 regularization of the lifetime and the transaction covariate parameters. Lambdas have to be &gt;= 0.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Depending on the data object on which the model was fit, <code>ggomnbd</code> returns either an object of
class <a href="clv.ggomnbd-class.html">clv.ggomnbd</a> or <a href="clv.ggomnbd.static.cov-class.html">clv.ggomnbd.static.cov</a>.</p>
<p>The function <code><a href="summary.clv.fitted.html">summary</a></code> can be used to obtain and print a summary of the results.
The generic accessor functions <code>coefficients</code>, <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>, and <code>nobs</code> are available.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Model parameters for the GGompertz/NBD model are <code>r, alpha, beta, b and s</code>. <br><code>r</code>: shape parameter of the Gamma distribution of the purchase process.
The smaller <code>r</code>, the stronger the heterogeneity of the purchase process.<br><code>alpha</code>: scale parameter of the Gamma distribution of the purchase process.<br><code>beta</code>: scale parameter for the Gamma distribution for the lifetime process.<br><code>b</code>: scale parameter of the Gompertz distribution (constant across customers).<br><code>s</code>: shape parameter of the Gamma distribution for the lifetime process.
The smaller <code>s</code>, the stronger the heterogeneity of customer lifetimes.</p>
<p>If no start parameters are given, r=0.5, alpha=2, b=0.1, s=1, beta=0.1 is used.
All model start parameters are required to be &gt; 0. If no start values are given for the covariate parameters,
0.1 is used.</p>
<p>Note that the DERT expression has not been derived (yet) and it consequently is not possible to calculated
values for DERT and CLV.</p>
<div class="section">
<h3 id="the-gamma-gompertz-nbd-model">The Gamma-Gompertz/NBD model<a class="anchor" aria-label="anchor" href="#the-gamma-gompertz-nbd-model"></a></h3>
<p>There are two key differences of the gamma/Gompertz/NBD (GGompertz/NBD) model compared to the relative to the well-known Pareto/NBD
model: (i) its probability density function can exhibit a mode at zero or an interior mode, and (ii) it can be skewed
to the right or to the left. Therefore, the GGompertz/NBD model is more flexible than the Pareto/NBD model.
According to Bemmaor and Glady (2012) can indicate substantial differences in expected residual lifetimes compared to the Pareto/NBD.
The GGompertz/NBD tends to be appropriate when firms are reputed and their offerings are differentiated.</p>
</div>

    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bemmaor AC, Glady N (2012). “Modeling Purchasing Behavior with Sudden “Death”: A Flexible Customer
Lifetime Model” Management Science, 58(5), 1012-1021.</p>
<p>Adler J (2022).  “Comment on “Modeling Purchasing Behavior with Sudden “Death”: A Flexible Customer
Lifetime Model” Management Science 69(3):1929-1930.</p>
<p>The expression for the PMF was derived by Adler J (2024). (unpublished)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="clvdata.html">clvdata</a></code> to create a clv data object, <code><a href="SetStaticCovariates.html">SetStaticCovariates</a></code>
to add static covariates to an existing clv data object.</p>
<p><a href="gg.html">gg</a> to fit customer's average spending per transaction with the <code>Gamma-Gamma</code> model</p>
<p><code><a href="predict.clv.fitted.transactions.html">predict</a></code> to predict expected transactions, probability of being alive, and customer lifetime value for every customer</p>
<p><code><a href="plot.clv.fitted.transactions.html">plot</a></code> to plot the unconditional expectation as predicted by the fitted model</p>
<p><code><a href="pmf.html">pmf</a></code> for the probability to make exactly x transactions in the estimation period, given by the probability mass function (PMF).</p>
<p><code><a href="newcustomer.html">newcustomer</a></code> to predict the expected number of transactions for an average new customer.</p>
<p>The generic functions <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="summary.clv.fitted.html">summary</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelTrans"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.apparel</span> <span class="op">&lt;-</span> <span class="fu"><a href="clvdata.html">clvdata</a></span><span class="op">(</span><span class="va">apparelTrans</span>, date.format <span class="op">=</span> <span class="st">"ymd"</span>,</span></span>
<span class="r-in"><span>                            time.unit <span class="op">=</span> <span class="st">"w"</span>, estimation.split <span class="op">=</span> <span class="fl">52</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit standard ggomnbd model</span></span></span>
<span class="r-in"><span><span class="fu">ggomnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GGompertz/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggomnbd(clv.data = clv.data.apparel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         r      alpha          b          s       beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.309e+00  4.634e+01  1.187e-04  4.750e-01  8.248e-03  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Give initial guesses for the model parameters</span></span></span>
<span class="r-in"><span><span class="fu">ggomnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>     start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">15</span>, b<span class="op">=</span><span class="fl">5</span>, beta<span class="op">=</span><span class="fl">10</span>, s<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Estimation failed with NA coefficients. The returned object contains results but further usage is restricted. You might want to try to fit the model again with method Nelder-Mead (using optimx.args=list(method="Nelder-Mead")) or try different starting values. See examples.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Hessian could not be derived. Setting all entries to NA.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GGompertz/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggomnbd(clv.data = clv.data.apparel, start.params.model = c(r = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alpha = 15, b = 5, beta = 10, s = 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     r  alpha      b      s   beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    NA     NA     NA     NA     NA  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: NA </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pass additional parameters to the optimizer (optimx)</span></span></span>
<span class="r-in"><span><span class="co">#    Use Nelder-Mead as optimization method and print</span></span></span>
<span class="r-in"><span><span class="co">#    detailed information about the optimization process</span></span></span>
<span class="r-in"><span><span class="va">apparel.ggomnbd</span> <span class="op">&lt;-</span> <span class="fu">ggomnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                     optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span></span>
<span class="r-in"><span>                                        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn is  fn1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Looking for method =  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Methods to be used:[1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optcfg:$fname</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fn1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $npar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$follow.on</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$save.failures</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$trace</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$all.methods</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$starttests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$maximize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$dowarn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkttol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt2tol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$badval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.988466e+307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$scaletol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ufn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (par) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn(par, ...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x141ed5458&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x153b0f760&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Nelder-Mead direct search function minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function value for initial parameters = 5007.682901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Scaled convergence tolerance is 7.46203e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stepsize computed as 0.230259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BUILD              6 5442.156737 4940.535538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION          8 5274.518932 4478.460845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      10 5042.844993 4478.460845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      12 5007.682901 4478.460845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         14 4975.291614 4204.231102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      16 4940.535538 4204.231102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         18 4560.511729 3846.998230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      20 4544.492656 3846.998230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      22 4478.460845 3846.998230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         24 4224.209660 3655.491805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      26 4204.231102 3655.491805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      28 3966.230645 3655.491805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      30 3907.444304 3655.491805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         32 3846.998230 3514.922022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      34 3688.613512 3514.922022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      36 3672.786917 3514.922022</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        38 3669.920469 3510.550033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        40 3655.491805 3498.571310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      42 3543.401435 3497.105491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      44 3542.285254 3497.105491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      46 3514.922022 3497.105491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      48 3510.550033 3497.105491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      50 3506.803363 3497.105491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        52 3502.798591 3494.496828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      54 3502.181541 3494.496828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      56 3498.571310 3494.496828</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        58 3497.313598 3493.565337</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         60 3497.105491 3489.279358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         62 3495.039577 3487.467587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      64 3494.621786 3487.467587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      66 3494.496828 3487.467587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         68 3493.565337 3486.220414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      70 3490.573813 3486.217731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      72 3489.279358 3486.217731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      74 3487.974737 3486.136583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      76 3487.467587 3486.136583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      78 3486.962485 3486.136583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      80 3486.301259 3486.136583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      82 3486.220414 3486.065167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      84 3486.217731 3486.065167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      86 3486.207573 3486.065167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        88 3486.184057 3485.992249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      90 3486.136583 3485.992249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      92 3486.081667 3485.992249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      94 3486.072748 3485.992249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        96 3486.065167 3485.986712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        98 3486.048959 3485.965877</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        100 3486.024422 3485.917933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        102 3486.019173 3485.840122</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        104 3485.992249 3485.775640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        106 3485.986712 3485.667857</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        108 3485.965877 3485.434055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     110 3485.917933 3485.434055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        112 3485.840122 3484.693242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     114 3485.775640 3484.693242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        116 3485.667857 3484.002742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     118 3485.483175 3484.002742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        120 3485.434055 3483.471043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     122 3484.959840 3483.471043</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       124 3484.693242 3483.356447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     126 3484.553868 3483.356447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     128 3484.002742 3483.356447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     130 3483.811724 3483.356447</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       132 3483.676112 3483.295254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       134 3483.653586 3483.273009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     136 3483.471043 3483.273009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       138 3483.419501 3483.194748</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       140 3483.356447 3483.164309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       142 3483.319503 3483.129896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     144 3483.295254 3483.129896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     146 3483.273009 3483.129896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     148 3483.194748 3483.129896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       150 3483.164309 3483.112342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       152 3483.155804 3483.093604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       154 3483.142984 3483.084739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     156 3483.140003 3483.084739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     158 3483.129896 3483.082021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     160 3483.112342 3483.081444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     162 3483.094962 3483.081444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     164 3483.093604 3483.079062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        166 3483.087381 3483.046706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     168 3483.084739 3483.046706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     170 3483.082021 3483.046706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     172 3483.081444 3483.046706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     174 3483.079062 3483.046706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        176 3483.070740 3483.027238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     178 3483.061490 3483.027238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     180 3483.059875 3483.027238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        182 3483.057996 3483.003021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     184 3483.047079 3483.003021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        186 3483.046706 3482.977434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     188 3483.028818 3482.977434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        190 3483.027238 3482.957825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        192 3483.018135 3482.916903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     194 3483.003021 3482.916903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       196 3482.977758 3482.906631</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        198 3482.977434 3482.882348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     200 3482.957825 3482.882348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     202 3482.929074 3482.882348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     204 3482.916903 3482.882348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     206 3482.906631 3482.882348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     208 3482.905887 3482.882348</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        210 3482.894189 3482.871572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     212 3482.893320 3482.871572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     214 3482.893276 3482.871572</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        216 3482.888397 3482.857974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     218 3482.883513 3482.857974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     220 3482.882348 3482.857974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        222 3482.881510 3482.848978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        224 3482.871572 3482.833107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        226 3482.868137 3482.817666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     228 3482.867681 3482.817666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        230 3482.857974 3482.807759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     232 3482.848978 3482.807759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     234 3482.833107 3482.807759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        236 3482.832063 3482.794215</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        238 3482.826967 3482.785922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     240 3482.818498 3482.785922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     242 3482.817666 3482.785922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     244 3482.807759 3482.785922</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        246 3482.806784 3482.761353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     248 3482.794215 3482.761353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     250 3482.790644 3482.761353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     252 3482.788720 3482.761353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        254 3482.785922 3482.755701</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        256 3482.780827 3482.740430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     258 3482.771469 3482.740430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       260 3482.768076 3482.737903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     262 3482.761353 3482.737903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     264 3482.755701 3482.737903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     266 3482.748851 3482.737903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     268 3482.747416 3482.737903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       270 3482.743241 3482.735445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     272 3482.740598 3482.735445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     274 3482.740430 3482.735445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        276 3482.739764 3482.732195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        278 3482.738342 3482.728411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     280 3482.737903 3482.728411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        282 3482.736837 3482.727144</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        284 3482.735445 3482.714835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        286 3482.732195 3482.701571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     288 3482.729380 3482.701571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     290 3482.728411 3482.701571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        292 3482.727144 3482.693941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        294 3482.716837 3482.663532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     296 3482.714835 3482.663532</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        298 3482.709825 3482.628475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     300 3482.701571 3482.628475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     302 3482.693941 3482.628475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        304 3482.674222 3482.569643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     306 3482.663532 3482.569643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        308 3482.637750 3482.507080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     310 3482.636899 3482.507080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        312 3482.628475 3482.440233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        314 3482.572557 3482.391042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        316 3482.569643 3482.343151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        318 3482.521875 3482.216396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     320 3482.507080 3482.216396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     322 3482.440233 3482.216396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     324 3482.391042 3482.216396</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        326 3482.343151 3482.159796</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       328 3482.304538 3482.113614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       330 3482.279491 3482.111540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     332 3482.252750 3482.111540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       334 3482.216396 3482.080384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     336 3482.159796 3482.080384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     338 3482.146908 3482.080384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        340 3482.130251 3482.036502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     342 3482.113614 3482.036502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     344 3482.111540 3482.036502</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        346 3482.107501 3482.006635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     348 3482.080384 3482.006635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       350 3482.073242 3482.003591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       352 3482.065516 3481.989694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     354 3482.036502 3481.989694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     356 3482.023909 3481.989694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     358 3482.006635 3481.989694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     360 3482.003591 3481.989694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       362 3481.996197 3481.989261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     364 3481.994979 3481.989261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     366 3481.994685 3481.988358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     368 3481.990599 3481.988358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     370 3481.990454 3481.988177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     372 3481.989694 3481.988177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     374 3481.989647 3481.988100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     376 3481.989261 3481.988100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     378 3481.988358 3481.988100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     380 3481.988297 3481.987946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     382 3481.988185 3481.987837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     384 3481.988177 3481.987837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     386 3481.988117 3481.987837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     388 3481.988100 3481.987837</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     390 3481.987946 3481.987825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       392 3481.987862 3481.987761</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     394 3481.987850 3481.987752</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       396 3481.987847 3481.987744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     398 3481.987837 3481.987744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     400 3481.987825 3481.987744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exiting from Nelder Mead minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     402 function evaluations used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post processing for method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Successful convergence! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute Hessian approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute gradient approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Save results from method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      log.r  log.alpha      log.b      log.s   log.beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.2642132  3.8328455 -5.8976873 -0.8657877 -1.7463581 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3481.988</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convcode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      402 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nitns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xtimes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> user.self </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      0.18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assemble the answers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimated coefs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">apparel.ggomnbd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            r        alpha            b            s         beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.302405809 46.193794125  0.002745788  0.420720023  0.174407964 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary of the fitted model.</span></span></span>
<span class="r-in"><span><span class="co"># Note that the significance indicators are set to NA on purpose because all</span></span></span>
<span class="r-in"><span><span class="co"># model parameters are by definition strictly positive. A hypothesis test</span></span></span>
<span class="r-in"><span><span class="co"># relative to a null of 0 therefore does not make sense.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">apparel.ggomnbd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GGompertz/NBD Standard  Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggomnbd(clv.data = clv.data.apparel, optimx.args = list(method = "Nelder-Mead", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = list(trace = 6)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting period:                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation start  2005-01-02   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation end    2006-01-01   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation length 52.0000 Weeks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error z-val Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r      1.302406   0.229943    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha 46.193794   7.513529    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b      0.002746   0.028817    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s      0.420720   1.184962    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta   0.174408   1.572658    NA       NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization info:                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LL     -3481.9877 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC    6973.9755  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC    6995.9601  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 1  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 2  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fevals 402.0000   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method Nelder-Mead</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict CLV etc for holdout period</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.ggomnbd</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2010-12-20 (259.14 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2010-12-20      259.1429        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2010-12-20      259.1429        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2010-12-20      259.1429        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2010-12-20      259.1429        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending predicted.mean.spending predicted.period.spending</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;                   &lt;num&gt;                     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                 524.10                63.77959                 249.79933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                  63.31                38.10316                 136.91419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                 333.35                37.12434                  59.28538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                   0.00                33.08404                 126.47710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                   0.00                37.12434                  59.28538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                 113.80                28.29614                 113.74903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                 253.61                37.12434                  59.28538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                   0.00                37.12434                  59.28538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                   0.00                34.87739                 144.08847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                  13.99                16.11315                  92.74449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           CET    PAlive</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 3.916603 0.9143792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 3.593251 0.8388887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 1.596941 0.6590848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 3.822904 0.8925040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 1.596941 0.6590848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596: 4.019948 0.9385066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597: 1.596941 0.6590848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598: 1.596941 0.6590848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599: 4.131286 0.9644998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600: 5.755828 0.9368629</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict CLV etc for the next 15 periods</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.ggomnbd</span>, prediction.end <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2006-04-16 (15 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;int&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2006-04-16            15        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.period.spending predicted.mean.spending predicted.period.spending</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       &lt;num&gt;                   &lt;num&gt;                     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                  217.5                63.77959                 19.918293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                    0.0                38.10316                 10.917150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                    0.0                37.12434                  4.727249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                    0.0                33.08404                 10.084926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                    0.0                37.12434                  4.727249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                    0.0                28.29614                  9.070027</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                    0.0                37.12434                  4.727249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                    0.0                37.12434                  4.727249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                    0.0                34.87739                 11.489208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                    0.0                16.11315                  7.395184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            CET    PAlive</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 0.3122988 0.9143792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 0.2865157 0.8388887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 0.1273356 0.6590848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 0.3048275 0.8925040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 0.1273356 0.6590848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596: 0.3205393 0.9385066</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597: 0.1273356 0.6590848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598: 0.1273356 0.6590848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599: 0.3294171 0.9644998</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600: 0.4589534 0.9368629</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># To estimate the ggomnbd model with static covariates,</span></span></span>
<span class="r-in"><span><span class="co">#   add static covariates to the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelStaticCov"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.static.cov</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="SetStaticCovariates.html">SetStaticCovariates</a></span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                     data.cov.life <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span></span>
<span class="r-in"><span>                     names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     data.cov.trans <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span></span>
<span class="r-in"><span>                     names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit ggomnbd with static covariates</span></span></span>
<span class="r-in"><span><span class="fu">ggomnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GGompertz/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggomnbd(clv.data = clv.data.static.cov)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              b              s           beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1.649e+00      1.039e+02      8.969e-05      3.738e-01      2.661e-02  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   life.Gender   life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -2.227e-02      2.733e+00      4.696e-01      7.360e-01  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Give initial guesses for both covariate parameters</span></span></span>
<span class="r-in"><span><span class="fu">ggomnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.75</span>, Channel<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   start.params.life  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span>, Channel<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GGompertz/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggomnbd(clv.data = clv.data.static.cov, start.params.life = c(Gender = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Channel = 0.5), start.params.trans = c(Gender = 0.75, Channel = 0.7))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              b              s           beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1.643552     103.793189       0.004312       0.329045       1.299324  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   life.Gender   life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     -0.017505       2.875669       0.470102       0.737475  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use regularization</span></span></span>
<span class="r-in"><span><span class="fu">ggomnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="fl">5</span>, life<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GGompertz/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggomnbd(clv.data = clv.data.static.cov, reg.lambdas = c(trans = 5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     life = 5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              b              s           beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1.307e+00      4.668e+01      1.468e-02      2.306e-01      5.200e-01  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   life.Gender   life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    -6.485e-04     -6.156e-05      6.162e-03      6.700e-03  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  TRUE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Force the same coefficient to be used for both covariates</span></span></span>
<span class="r-in"><span><span class="fu">ggomnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.constr <span class="op">=</span> <span class="st">"Gender"</span>,</span></span>
<span class="r-in"><span>                   start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GGompertz/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggomnbd(clv.data = clv.data.static.cov, names.cov.constr = "Gender", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     start.params.constr = c(Gender = 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              b              s           beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1.615e+00      1.041e+02      3.428e-03      3.229e-01      1.891e+00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel  trans.Channel  constr.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3.178e+00      7.327e-01      4.923e-01  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model only with the Channel covariate for life but</span></span></span>
<span class="r-in"><span><span class="co"># keep all trans covariates as is</span></span></span>
<span class="r-in"><span><span class="fu">ggomnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GGompertz/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ggomnbd(clv.data = clv.data.static.cov, names.cov.life = c("Channel"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              b              s           beta  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1.639e+00      1.036e+02      4.731e-03      3.329e-01      1.472e+00  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2.869e+00      4.713e-01      7.365e-01  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Bachmann, Niels Kuebler, Markus Meierer, Jeffrey Naef, E. Shin Oblander, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

