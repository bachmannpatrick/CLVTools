<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>BG/NBD models — bgnbd • CLVTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="BG/NBD models — bgnbd"><meta property="og:description" content="Fits BG/NBD models on transactional data without and with static covariates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-31477052-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-31477052-2');
</script></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CLVTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.11.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/CLVTools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/internal_docu/internal_docu.html">Internal Package Documentation</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/bachmannpatrick/CLVTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>BG/NBD models</h1>
    <small class="dont-index">Source: <a href="https://github.com/bachmannpatrick/CLVTools/blob/master/R/f_interface_bgnbd.R" class="external-link"><code>R/f_interface_bgnbd.R</code></a></small>
    <div class="hidden name"><code>bgnbd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits BG/NBD models on transactional data without and with static covariates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'clv.data'</span></span>
<span><span class="fu">bgnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'clv.data.static.covariates'</span></span>
<span><span class="fu">bgnbd</span><span class="op">(</span></span>
<span>  <span class="va">clv.data</span>,</span>
<span>  start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  names.cov.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-clv-data">clv.data<a class="anchor" aria-label="anchor" href="#arg-clv-data"></a></dt>
<dd><p>The data object on which the model is fitted.</p></dd>


<dt id="arg-start-params-model">start.params.model<a class="anchor" aria-label="anchor" href="#arg-start-params-model"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for the model without covariates.</p></dd>


<dt id="arg-optimx-args">optimx.args<a class="anchor" aria-label="anchor" href="#arg-optimx-args"></a></dt>
<dd><p>Additional arguments to control the optimization which are forwarded to <code><a href="https://rdrr.io/pkg/optimx/man/optimx.html" class="external-link">optimx::optimx</a></code>.
If multiple optimization methods are specified, only the result of the last method is further processed.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Show details about the running of the function.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Ignored</p></dd>


<dt id="arg-names-cov-life">names.cov.life<a class="anchor" aria-label="anchor" href="#arg-names-cov-life"></a></dt>
<dd><p>Which of the set Lifetime covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>


<dt id="arg-names-cov-trans">names.cov.trans<a class="anchor" aria-label="anchor" href="#arg-names-cov-trans"></a></dt>
<dd><p>Which of the set Transaction covariates should be used. Missing parameter indicates all covariates shall be used.</p></dd>


<dt id="arg-start-params-life">start.params.life<a class="anchor" aria-label="anchor" href="#arg-start-params-life"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for all lifetime covariates.</p></dd>


<dt id="arg-start-params-trans">start.params.trans<a class="anchor" aria-label="anchor" href="#arg-start-params-trans"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for all transaction covariates.</p></dd>


<dt id="arg-names-cov-constr">names.cov.constr<a class="anchor" aria-label="anchor" href="#arg-names-cov-constr"></a></dt>
<dd><p>Which covariates should be forced to use the same parameters for the lifetime and transaction process. The covariates need to be present as both, lifetime and transaction covariates.</p></dd>


<dt id="arg-start-params-constr">start.params.constr<a class="anchor" aria-label="anchor" href="#arg-start-params-constr"></a></dt>
<dd><p>Named start parameters containing the optimization start parameters for the constraint covariates.</p></dd>


<dt id="arg-reg-lambdas">reg.lambdas<a class="anchor" aria-label="anchor" href="#arg-reg-lambdas"></a></dt>
<dd><p>Named lambda parameters used for the L2 regularization of the lifetime and the transaction covariate parameters. Lambdas have to be &gt;= 0.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Depending on the data object on which the model was fit, <code>bgnbd</code> returns either an object of
class <a href="clv.bgnbd-class.html">clv.bgnbd</a> or <a href="clv.bgnbd.static.cov-class.html">clv.bgnbd.static.cov</a>.</p>
<p>The function <code><a href="summary.clv.fitted.html">summary</a></code> can be used to obtain and print a summary of the results.
The generic accessor functions <code>coefficients</code>, <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>,
<code>logLik</code>, <code>AIC</code>, <code>BIC</code>, and <code>nobs</code> are available.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Model parameters for the BG/NBD model are <code>r, alpha, a, and b</code>. <br><code>r</code>: shape parameter of the Gamma distribution of the purchase process. <br><code>alpha</code>: scale parameter of the Gamma distribution of the purchase process. <br><code>a</code>: shape parameter of the Beta distribution of the dropout process.<br><code>b</code>: shape parameter of the Beta distribution of the dropout process.</p>
<p>If no start parameters are given, r = 1, alpha = 3, a = 1, b = 3 is used.
All model start parameters are required to be &gt; 0. If no start values are given for the
covariate parameters, 0.1 is used.</p>
<p>Note that the DERT expression has not been derived (yet) and it consequently is not possible to calculated
values for DERT and CLV.</p>


<div class="section">
<h3 id="the-bg-nbd-model">The BG/NBD model<a class="anchor" aria-label="anchor" href="#the-bg-nbd-model"></a></h3>
<p>The BG/NBD is an "easy" alternative to the Pareto/NBD model that is easier to implement. The BG/NBD model slight adapts
the behavioral "story" associated with the Pareto/NBD model in order to simplify the implementation. The BG/NBD model uses a beta-geometric and
exponential gamma mixture distributions to model customer behavior. The key difference to the Pareto/NBD model is that a customer can only
churn right after a transaction. This simplifies computations significantly, however has the drawback that a customer cannot churn until he/she
makes a transaction. The Pareto/NBD model assumes that a customer can churn at any time.</p>
</div>

<div class="section">
<h3 id="bg-nbd-model-with-static-covariates">BG/NBD model with static covariates<a class="anchor" aria-label="anchor" href="#bg-nbd-model-with-static-covariates"></a></h3>
<p>The standard BG/NBD model captures heterogeneity was solely using Gamma distributions.
However, often exogenous knowledge, such as for example customer demographics, is available.
The supplementary knowledge may explain part of the heterogeneity among the customers and
therefore increase the predictive accuracy of the model. In addition, we can rely on these
parameter estimates for inference, i.e. identify and quantify effects of contextual factors
on the two underlying purchase and attrition processes. For technical details we refer to
the technical note by Fader and Hardie (2007).</p>
<p>The likelihood function is the likelihood function associated with the basic model where
alpha, a, and b are replaced with alpha = alpha0*exp(-g1z1), a = a_0*exp(g2z2), and b = b0*exp(g3z2)
while r remains unchanged. Note that in the current implementation, we constrain the covariate parameters
and data for the lifetime process to be equal (g2=g3 and z2=z3).</p>
</div>

    </div>
    <div id="references">
    <h2>References</h2>
    <p>Fader PS, Hardie BGS, Lee KL (2005). ““Counting Your Customers” the Easy Way:
An Alternative to the Pareto/NBD Model” Marketing Science, 24(2), 275-284.</p>
<p>Fader PS, Hardie BGS (2013). “Overcoming the BG/NBD Model's #NUM! Error Problem”
URL <a href="http://brucehardie.com/notes/027/bgnbd_num_error.pdf" class="external-link">http://brucehardie.com/notes/027/bgnbd_num_error.pdf</a>.</p>
<p>Fader PS, Hardie BGS (2007). “Incorporating time-invariant covariates into the
Pareto/NBD and BG/NBD models.”
URL <a href="http://www.brucehardie.com/notes/019/time_invariant_covariates.pdf" class="external-link">http://www.brucehardie.com/notes/019/time_invariant_covariates.pdf</a>.</p>
<p>Fader PS, Hardie BGS, Lee KL (2007). “Creating a Fit Histogram for the BG/NBD Model”
URL <a href="https://www.brucehardie.com/notes/014/bgnbd_fit_histogram.pdf" class="external-link">https://www.brucehardie.com/notes/014/bgnbd_fit_histogram.pdf</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="clvdata.html">clvdata</a></code> to create a clv data object, <code><a href="SetStaticCovariates.html">SetStaticCovariates</a></code>
to add static covariates to an existing clv data object.</p>
<p><a href="gg.html">gg</a> to fit customer's average spending per transaction with the <code>Gamma-Gamma</code> model</p>
<p><code><a href="predict.clv.fitted.transactions.html">predict</a></code> to predict expected transactions, probability of being alive, and customer lifetime value for every customer</p>
<p><code><a href="plot.clv.fitted.transactions.html">plot</a></code> to plot the unconditional expectation as predicted by the fitted model</p>
<p><code><a href="pmf.html">pmf</a></code> for the probability to make exactly x transactions in the estimation period, given by the probability mass function (PMF).</p>
<p><code><a href="newcustomer.html">newcustomer</a></code> to predict the expected number of transactions for an average new customer.</p>
<p>The generic functions <code><a href="vcov.clv.fitted.html">vcov</a></code>, <code><a href="summary.clv.fitted.html">summary</a></code>, <code><a href="fitted.clv.fitted.html">fitted</a></code>.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelTrans"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.apparel</span> <span class="op">&lt;-</span> <span class="fu"><a href="clvdata.html">clvdata</a></span><span class="op">(</span><span class="va">apparelTrans</span>, date.format <span class="op">=</span> <span class="st">"ymd"</span>,</span></span>
<span class="r-in"><span>                            time.unit <span class="op">=</span> <span class="st">"w"</span>, estimation.split <span class="op">=</span> <span class="fl">52</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit standard bgnbd model</span></span></span>
<span class="r-in"><span><span class="fu">bgnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BG/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bgnbd(clv.data = clv.data.apparel)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        r     alpha         a         b  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.8053   28.1251   33.9420  297.9476  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Give initial guesses for the model parameters</span></span></span>
<span class="r-in"><span><span class="fu">bgnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>     start.params.model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>r<span class="op">=</span><span class="fl">0.5</span>, alpha<span class="op">=</span><span class="fl">15</span>, a <span class="op">=</span> <span class="fl">2</span>, b<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BG/NBD Standard Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bgnbd(clv.data = clv.data.apparel, start.params.model = c(r = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     alpha = 15, a = 2, b = 5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        r     alpha         a         b  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.8053   28.1250   17.8092  155.9075  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># pass additional parameters to the optimizer (optimx)</span></span></span>
<span class="r-in"><span><span class="co">#    Use Nelder-Mead as optimization method and print</span></span></span>
<span class="r-in"><span><span class="co">#    detailed information about the optimization process</span></span></span>
<span class="r-in"><span><span class="va">apparel.bgnbd</span> <span class="op">&lt;-</span> <span class="fu">bgnbd</span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                     optimx.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">"Nelder-Mead"</span>,</span></span>
<span class="r-in"><span>                                        control<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace<span class="op">=</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn is  fn1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Looking for method =  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Methods to be used:[1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Function has  4  arguments</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analytic gradient not made available.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analytic Hessian not made available.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Scale check -- log parameter ratio= 0   log bounds ratio= NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> optcfg:$fname</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fn1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $npar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$follow.on</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$save.failures</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$trace</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$all.methods</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$starttests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$maximize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$dowarn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkttol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$kkt2tol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$badval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.988466e+307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$scaletol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ctrl$have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $usenumDeriv</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ufn</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function (par) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fn(par, ...)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;bytecode: 0x114ab06a0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x120f9cb78&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $have.bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Nelder-Mead"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method:  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Nelder-Mead direct search function minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function value for initial parameters = 4151.799882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Scaled convergence tolerance is 6.18666e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Stepsize computed as 0.109861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BUILD              5 4280.255070 4100.393179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION          7 4153.744504 3915.863835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION       9 4151.799882 3915.863835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      11 4149.964916 3915.863835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         13 4100.393179 3743.714488</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         15 3999.765299 3643.905892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      17 3934.809847 3643.905892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         19 3915.863835 3545.539279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        21 3743.714488 3533.732535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      23 3651.998327 3533.732535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      25 3643.905892 3533.732535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      27 3546.207593 3533.732535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      29 3545.539279 3533.732535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      31 3543.179053 3533.732535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        33 3539.305199 3532.507588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         35 3538.374535 3530.696459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         37 3538.091523 3519.769546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      39 3533.732535 3519.769546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      41 3532.507588 3519.769546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         43 3530.696459 3510.869170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         45 3528.960114 3500.645882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         47 3521.674508 3497.483952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        49 3519.769546 3496.981145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        51 3510.869170 3487.401037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      53 3500.645882 3487.401037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      55 3498.387294 3487.401037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      57 3497.483952 3487.401037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      59 3496.981145 3487.401037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         61 3493.779517 3483.484534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      63 3492.391145 3483.484534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        65 3487.562394 3482.506270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      67 3487.401037 3482.506270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      69 3485.059649 3482.406091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      71 3483.484534 3482.406091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      73 3483.119256 3482.311166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      75 3482.548478 3482.295479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      77 3482.506270 3482.295479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      79 3482.406091 3482.295479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        81 3482.332045 3482.239338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION         83 3482.311166 3482.118275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      85 3482.308885 3482.118275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      87 3482.295479 3482.118275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      89 3482.239338 3482.118275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      91 3482.199259 3482.118275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        93 3482.172675 3482.105284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION      95 3482.142830 3482.105284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION      97 3482.129588 3482.102046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION        99 3482.118275 3482.092313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     101 3482.117122 3482.092313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     103 3482.105284 3482.092313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     105 3482.102046 3482.092313</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        107 3482.099316 3482.081815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     109 3482.098622 3482.081815</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       111 3482.095412 3482.081388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     113 3482.092313 3482.081388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     115 3482.089506 3482.081242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        117 3482.084208 3482.063702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     119 3482.081815 3482.063702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     121 3482.081388 3482.063702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        123 3482.081242 3482.056140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        125 3482.070868 3482.034983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     127 3482.070791 3482.034983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        129 3482.063702 3482.004107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        131 3482.056140 3481.985483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        133 3482.042600 3481.970263</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        135 3482.034983 3481.929101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        137 3482.004107 3481.899058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     139 3481.985483 3481.899058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       141 3481.970263 3481.884194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     143 3481.929101 3481.884194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     145 3481.916239 3481.884194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     147 3481.911364 3481.884194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       149 3481.899058 3481.873543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     151 3481.894943 3481.873543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        153 3481.887940 3481.860026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     155 3481.884280 3481.860026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     157 3481.884194 3481.860026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        159 3481.875645 3481.834342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     161 3481.873543 3481.834342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        163 3481.861245 3481.808343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     165 3481.860026 3481.808343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        167 3481.844796 3481.771985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        169 3481.834342 3481.710388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     171 3481.811157 3481.710388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        173 3481.808343 3481.659444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     175 3481.771985 3481.659444</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        177 3481.738120 3481.546219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     179 3481.710388 3481.546219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     181 3481.673018 3481.546219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        183 3481.659444 3481.442660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        185 3481.580223 3481.332356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     187 3481.560677 3481.332356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     189 3481.546219 3481.332356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        191 3481.442660 3481.149769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     193 3481.363321 3481.149769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        195 3481.336982 3481.070098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     197 3481.332356 3481.070098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       199 3481.178984 3481.010361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       201 3481.149769 3480.994551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     203 3481.122596 3480.994551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        205 3481.070098 3480.878659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     207 3481.016512 3480.878659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     209 3481.010361 3480.878659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     211 3480.994551 3480.878659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        213 3480.936156 3480.837135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     215 3480.906129 3480.837135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        217 3480.899800 3480.762303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     219 3480.878659 3480.762303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     221 3480.839151 3480.762303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     223 3480.837135 3480.762303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        225 3480.820055 3480.724384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        227 3480.819875 3480.682886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     229 3480.800900 3480.682886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        231 3480.762303 3480.571699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     233 3480.724384 3480.571699</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        235 3480.697648 3480.512261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     237 3480.682886 3480.512261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       239 3480.578663 3480.484309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     241 3480.571699 3480.484309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     243 3480.519896 3480.484309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     245 3480.512261 3480.484309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     247 3480.506665 3480.484309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       249 3480.496582 3480.473331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     251 3480.490801 3480.473331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     253 3480.487491 3480.473331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     255 3480.484309 3480.473331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     257 3480.484017 3480.473331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       259 3480.478597 3480.471558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        261 3480.476817 3480.468428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     263 3480.476590 3480.468428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     265 3480.473331 3480.468428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     267 3480.472230 3480.468428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       269 3480.471558 3480.467359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     271 3480.469478 3480.467359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        273 3480.468893 3480.465987</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        275 3480.468428 3480.462986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     277 3480.467832 3480.462986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     279 3480.467359 3480.462986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     281 3480.465987 3480.462986</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        283 3480.464129 3480.459635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     285 3480.464061 3480.459635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        287 3480.463354 3480.458583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        289 3480.462986 3480.455487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        291 3480.460281 3480.450407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     293 3480.459635 3480.450407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     295 3480.458583 3480.450407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     297 3480.455487 3480.450407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        299 3480.452277 3480.448651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        301 3480.452089 3480.445790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     303 3480.451616 3480.445790</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        305 3480.450407 3480.445291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     307 3480.448651 3480.445291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        309 3480.448212 3480.442242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        311 3480.446452 3480.441184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        313 3480.445790 3480.439890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     315 3480.445291 3480.439890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       317 3480.442242 3480.438633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     319 3480.441486 3480.438633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       321 3480.441184 3480.437912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     323 3480.440012 3480.437912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     325 3480.439890 3480.437912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        327 3480.439170 3480.436583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     329 3480.438633 3480.436583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     331 3480.438345 3480.436583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       333 3480.437912 3480.436268</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        335 3480.437323 3480.435759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     337 3480.436626 3480.435759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     339 3480.436583 3480.435759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     341 3480.436289 3480.435759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        343 3480.436268 3480.435378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     345 3480.436044 3480.435378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EXTENSION        347 3480.435836 3480.435224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     349 3480.435759 3480.435224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> REFLECTION       351 3480.435696 3480.435101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     353 3480.435378 3480.435101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     355 3480.435277 3480.435101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LO-REDUCTION     357 3480.435224 3480.435101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     359 3480.435185 3480.435101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> HI-REDUCTION     361 3480.435171 3480.435101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exiting from Nelder Mead minimizer</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     363 function evaluations used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Post processing for method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Successful convergence! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute Hessian approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Compute gradient approximation at finish of  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Save results from method  Nelder-Mead </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $par</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      log.r  log.alpha      log.a      log.b </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.2161996  3.3372999  4.2457936  6.4203498 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3480.435</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $message</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convcode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $fevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> function </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      363 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gevals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gradient </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       NA </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $nitns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $kkt2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $xtimes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> user.self </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     0.033 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Assemble the answers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimated coefs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">apparel.bgnbd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           r       alpha           a           b </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.8055745  28.1430359  69.8111419 614.2179147 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary of the fitted model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">apparel.bgnbd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BG/NBD Standard  Model </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bgnbd(clv.data = clv.data.apparel, optimx.args = list(method = "Nelder-Mead", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = list(trace = 6)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting period:                               </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation start  2005-01-02   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation end    2006-01-01   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimation length 52.0000 Weeks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error  z-val Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> r     8.056e-01  2.808e+00  0.287    0.774    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha 2.814e+01  2.808e+00 10.022   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a     6.981e+01  3.162e+03  0.022    0.982    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b     6.142e+02  2.790e+04  0.022    0.982    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization info:                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> LL     -3480.4351 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC    6968.8702  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC    6986.4579  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 1  TRUE       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT 2  FALSE      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fevals 363.0000   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method Nelder-Mead</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict CLV etc for holdout period</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.bgnbd</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2010-12-20 (259.14 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;num&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2010-12-20      259.1429        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2010-12-20      259.1429        9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2010-12-20      259.1429        5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2010-12-20      259.1429        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2010-12-20      259.1429        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2010-12-20      259.1429        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.total.spending predicted.mean.spending predicted.total.spending</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;num&gt;                   &lt;num&gt;                    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                524.10                63.77959                214.72904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                 63.31                38.10316                121.52449</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                333.35                37.12434                 74.71381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                  0.00                33.08404                109.75045</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                  0.00                37.12434                 74.71381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                113.80                28.29614                 96.76034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                253.61                37.12434                 74.71381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                  0.00                37.12434                 74.71381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                  0.00                34.87739                121.18754</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                 13.99                16.11315                 73.87009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           CET    PAlive</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 3.366736 0.8522351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 3.189355 0.8073340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 2.012529 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 3.317323 0.8397270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 2.012529 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596: 3.419559 0.8656065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597: 2.012529 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598: 2.012529 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599: 3.474674 0.8795578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600: 4.584461 0.8467480</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># predict CLV etc for the next 15 periods</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict.clv.fitted.transactions.html">predict</a></span><span class="op">(</span><span class="va">apparel.bgnbd</span>, prediction.end <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Predicting from 2006-01-02 until (incl.) 2006-04-16 (15 Weeks).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimating gg model to predict spending...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;Id&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Id period.first period.last period.length actual.x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;       &lt;Date&gt;      &lt;Date&gt;         &lt;int&gt;    &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:      1   2006-01-02  2006-04-16            15        2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     10   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    100   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    101   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    102   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:     95   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:     96   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:     97   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:     98   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:     99   2006-01-02  2006-04-16            15        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      actual.total.spending predicted.mean.spending predicted.total.spending</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;num&gt;                   &lt;num&gt;                    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:                 217.5                63.77959                17.889131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:                   0.0                38.10316                10.124236</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:                   0.0                37.12434                 5.502632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:                   0.0                33.08404                 9.143338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:                   0.0                37.12434                 5.502632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596:                   0.0                28.29614                 8.061128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597:                   0.0                37.12434                 5.502632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598:                   0.0                37.12434                 5.502632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599:                   0.0                34.87739                10.096165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600:                   0.0                16.11315                 6.912589</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            CET    PAlive</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 0.2804836 0.8522351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 0.2657060 0.8073340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 0.1482217 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 0.2763670 0.8397270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 0.1482217 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 596: 0.2848844 0.8656065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 597: 0.1482217 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 598: 0.1482217 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 599: 0.2894759 0.8795578</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 600: 0.4290031 0.8467480</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># To estimate the bgnbd model with static covariates,</span></span></span>
<span class="r-in"><span><span class="co">#   add static covariates to the data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"apparelStaticCov"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">clv.data.static.cov</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="SetStaticCovariates.html">SetStaticCovariates</a></span><span class="op">(</span><span class="va">clv.data.apparel</span>,</span></span>
<span class="r-in"><span>                     data.cov.life <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span></span>
<span class="r-in"><span>                     names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     data.cov.trans <span class="op">=</span> <span class="va">apparelStaticCov</span>,</span></span>
<span class="r-in"><span>                     names.cov.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gender"</span>, <span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit bgnbd with static covariates</span></span></span>
<span class="r-in"><span><span class="fu">bgnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BG/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bgnbd(clv.data = clv.data.static.cov)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              a              b    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.9457        57.4808        24.6330       211.4040         9.8270  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       -4.4347         0.5427         0.5743  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Give initial guesses for both covariate parameters</span></span></span>
<span class="r-in"><span><span class="fu">bgnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, start.params.trans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.75</span>, Channel<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                   start.params.life  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span>, Channel<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BG/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bgnbd(clv.data = clv.data.static.cov, start.params.life = c(Gender = 0.5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Channel = 0.5), start.params.trans = c(Gender = 0.75, Channel = 0.7))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              a              b    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.9421        57.2548        11.8422       109.9750         5.0240  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        1.4778         0.5314         0.5849  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use regularization</span></span></span>
<span class="r-in"><span><span class="fu">bgnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, reg.lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="fl">5</span>, life<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BG/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bgnbd(clv.data = clv.data.static.cov, reg.lambdas = c(trans = 5, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     life = 5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              a              b    life.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     8.143e-01      2.852e+01      9.055e-01      6.886e+00      1.104e-03  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  life.Channel   trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3.655e-04      5.582e-03      6.673e-03  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  TRUE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Force the same coefficient to be used for both covariates</span></span></span>
<span class="r-in"><span><span class="fu">bgnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.constr <span class="op">=</span> <span class="st">"Gender"</span>,</span></span>
<span class="r-in"><span>                   start.params.constr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Gender<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BG/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bgnbd(clv.data = clv.data.static.cov, names.cov.constr = "Gender", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     start.params.constr = c(Gender = 0.5))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              a              b   life.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.9413        57.2692         7.9569        73.4228         0.7795  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trans.Channel  constr.Gender  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.5861         0.5331  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model only with the Channel covariate for life but</span></span></span>
<span class="r-in"><span><span class="co"># keep all trans covariates as is</span></span></span>
<span class="r-in"><span><span class="fu">bgnbd</span><span class="op">(</span><span class="va">clv.data.static.cov</span>, names.cov.life <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Channel"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting estimation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Estimation finished!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BG/NBD with Static Covariates Model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bgnbd(clv.data = clv.data.static.cov, names.cov.life = c("Channel"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             r          alpha              a              b   life.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.9430        57.2833        15.2632       141.7392         2.5725  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  trans.Gender  trans.Channel  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0.5312         0.5837  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT1: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KKT2: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Constraints:     FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Regularization:  FALSE </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Patrick Bachmann, Niels Kuebler, Markus Meierer, Jeffrey Naef, E. Shin Oblander, Patrik Schilter.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

